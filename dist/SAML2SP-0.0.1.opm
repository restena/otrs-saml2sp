<?xml version="1.0" encoding="utf-8" ?>
<otrs_package version="1.1">
    <Name>SAML2SP</Name>
    <Version>0.0.1</Version>
    <Vendor>Restena.lu</Vendor>
    <URL>https://github.com/restena-ma/otrs-saml2sp/</URL>
    <License>GNU AFFERO GENERAL PUBLIC LICENSE Version 3, November 2007</License>
    <Description Lang="en">SAML2 Service Provider for agents authentication.</Description>
    <Framework>5.0.x</Framework>
    <BuildDate>2016-12-06 09:01:14</BuildDate>
    <BuildHost>ubuntu</BuildHost>
    <Filelist>
        <File Location="Kernel/System/Auth/SAML2SP.pm" Permission="644" Encode="Base64">IyAtLQojIEtlcm5lbDo6U3lzdGVtOjpBdXRoOjpTQU1MMlNQLnBtIC0gYXV0aGVudGljYXRpb24gbW9kdWxlCiMgQ29weXJpZ2h0IChDKSAoMjAxNikgKE1heGltZSBBcHBvbG9uaWEpIChtYXhpbWUuYXBwb2xvbmlhQHJlc3RlbmEubHUpCiMgLS0KIyBUaGlzIHNvZnR3YXJlIGNvbWVzIHdpdGggQUJTT0xVVEVMWSBOTyBXQVJSQU5UWS4gRm9yIGRldGFpbHMsIHNlZQojIHRoZSBlbmNsb3NlZCBmaWxlIENPUFlJTkcgZm9yIGxpY2Vuc2UgaW5mb3JtYXRpb24gKEFHUEwpLiBJZiB5b3UKIyBkaWQgbm90IHJlY2VpdmUgdGhpcyBmaWxlLCBzZWUgaHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzL2FncGwudHh0LgojIC0tCiMgTm90ZToKIwojICBJbiBvcmRlciB0byBkaXNwbGF5IGEgIkxvZ2luIHZpYSBTQU1MIiBidXR0b24geW91IGhhdmUgdG8gaW5jbHVkZSB0aGUgaHRtbCBjb2RlIGJlbG93IGludG8gdGhlIExvZ2luLnR0IHRlbXBsYXRlIGZpbGUgbmVhciB0aGUgbG9naW4gZm9ybQojCiMgIDwhLS0gQWRkIHRoZSBzc28gbG9naW4gYnV0dG9uIC0tPgojICA8ZGl2IGNsYXNzPSJDb250ZW50IiBzdHlsZT0idGV4dC1hbGlnbjogY2VudGVyOyBkaXNwbGF5OiBibG9jazsgaGVpZ2h0OiA0MHB4OyBwYWRkaW5nLXRvcDogMjBweDsgcGFkZGluZy1ib3R0b206IDA7IHZlcnRpY2FsLWFsaWduOiBib3R0b207IGxpbmUtaGVpZ2h0OiA0MHB4OyI+CiMgICAgPGEgaHJlZj0iLi9pbmRleC5wbD9BY3Rpb249TG9naW4mV2FudFNBTUxSZXF1ZXN0PXRydWUiIHN0eWxlPSJiYWNrZ3JvdW5kOiAjZTllOWU5OyBib3JkZXItcmFkaXVzOiA1cHg7IHBhZGRpbmc6IDEwcHg7Ym9yZGVyOiAxcHggc29saWQgI2NjYzsgZm9udC13ZWlnaHQ6IGJvbGQ7IiA+TG9naW4gdmlhIFNBTUwyIFNTTzwvYT4KIyAgPC9kaXY+CiMgIDwhLS0gZW5kIHNzbyBsb2dpbiBidXR0b24gLS0+CiMKIwojICBJbiB0aGUgRGVmYXVsdC5wbSB5b3UgY2FuIGFjdGl2ZSB0aGlzIGF1dGggbW9kdWxlIHdpdGggYSBmYWxsYmFjayBvbiB0aGUgZGVmYXVsdCBEQiBtb2R1bGUKIyAgCiMgICRTZWxmLT57QXV0aE1vZHVsZTF9ID0gJ0tlcm5lbDo6U3lzdGVtOjpBdXRoOjpEQic7CiMgICRTZWxmLT57QXV0aE1vZHVsZX0gPSAnS2VybmVsOjpTeXN0ZW06OkF1dGg6OlNBTUwyU1AnOwojICAkU2VsZi0+eydBdXRoTW9kdWxlOjpTQU1MMlNQOjpTU09JZHBVcmwnfSA9ICdodHRwczovL2lkcC5leGFtcGxlLmNvbS9zaW1wbGVzYW1sL3NhbWwyL2lkcC9TU09TZXJ2aWNlLnBocCc7CiMgICRTZWxmLT57J0F1dGhNb2R1bGU6OlNBTUwyU1A6OlNTT0Fzc2VydGlvbkNvbnN1bWVyVVJMJ30gPSAnL290cnMvaW5kZXgucGw/QWN0aW9uPUxvZ2luJzsKIyAgJFNlbGYtPnsnQXV0aE1vZHVsZTo6U0FNTDJTUDo6U1NPVXNlcklkQXR0cmlidXRlJ30gPSAnVXNlcklkJzsKIyAgJFNlbGYtPnsnQXV0aE1vZHVsZTo6U0FNTDJTUDo6U1NPeDUwOUNlcnQnfSA9ICItLS0tLUJFR0lOIENFUlRJRklDQVRFLS0tLS14eHh4eHh4LS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLSI7CiMKIyAtLQoKcGFja2FnZSBLZXJuZWw6OlN5c3RlbTo6QXV0aDo6U0FNTDJTUDsKCnVzZSBzdHJpY3Q7CnVzZSB3YXJuaW5nczsKCm91ciBAT2JqZWN0RGVwZW5kZW5jaWVzID0gKAogICAgJ0tlcm5lbDo6Q29uZmlnJywKICAgICdLZXJuZWw6OlN5c3RlbTo6V2ViOjpSZXF1ZXN0JywKICAgICdLZXJuZWw6OlN5c3RlbTo6TG9nJwopOwoKCnVzZSBDR0k7CiN1c2UgRmluZEJpbiBxdygkQmluKTsKI3VzZSBsaWIgIiRCaW4vLi4vIjsKdXNlIEtlcm5lbDo6U3lzdGVtOjpBdXRoOjpTQU1MMlNQOjpDb25maWc7CnVzZSBLZXJuZWw6OlN5c3RlbTo6QXV0aDo6U0FNTDJTUDo6QXV0aFJlcXVlc3Q7CnVzZSBLZXJuZWw6OlN5c3RlbTo6QXV0aDo6U0FNTDJTUDo6UmVzcG9uc2U7CgpzdWIgbmV3IHsKICAgIG15ICggJFR5cGUsICVQYXJhbSApID0gQF87CgogICAgIyBhbGxvY2F0ZSBuZXcgaGFzaCBmb3Igb2JqZWN0CiAgICBteSAkU2VsZiA9IHt9OwogICAgYmxlc3MoICRTZWxmLCAkVHlwZSApOwoKICAgICMgRGVidWcgMD1vZmYgMT1vbgogICAgJFNlbGYtPntEZWJ1Z30gPSAwOwoKICAgICMgZ2V0IGNvbmZpZyBvYmplY3QKICAgIG15ICRDb25maWdPYmplY3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OkNvbmZpZycpOwoKCiAgICAjIGdldCBjb25maWcKICAgICRTZWxmLT57U1NPSWRwVXJsfSA9ICRDb25maWdPYmplY3QtPkdldCggJ0F1dGhNb2R1bGU6OlNBTUwyU1A6OlNTT0lkcFVybCcgLiAkUGFyYW17Q291bnR9ICkgfHwgZGllICJOZWVkIEF1dGhNb2R1bGU6OlNBTUwyU1A6OlNTT0lkcFVybHtDb3VudH0gaW4gS2VybmVsL0NvbmZpZy5wbSI7CiAgICAkU2VsZi0+e1NTT0Fzc2VydGlvbkNvbnN1bWVyVVJMfSA9ICRDb25maWdPYmplY3QtPkdldCggJ0F1dGhNb2R1bGU6OlNBTUwyU1A6OlNTT0Fzc2VydGlvbkNvbnN1bWVyVVJMJyAuICRQYXJhbXtDb3VudH0gKSB8fCBkaWUgIk5lZWQgQXV0aE1vZHVsZTo6U0FNTDJTUDo6U1NPQXNzZXJ0aW9uQ29uc3VtZXJVUkx7Q291bnR9IGluIEtlcm5lbC9Db25maWcucG0iOwogICAgJFNlbGYtPntTU09Vc2VySWRBdHRyaWJ1dGV9ID0gJENvbmZpZ09iamVjdC0+R2V0KCAnQXV0aE1vZHVsZTo6U0FNTDJTUDo6U1NPVXNlcklkQXR0cmlidXRlJyAuICRQYXJhbXtDb3VudH0gKSB8fCBkaWUgIk5lZWQgQXV0aE1vZHVsZTo6U0FNTDJTUDo6U1NPVXNlcklkQXR0cmlidXRle0NvdW50fSBpbiBLZXJuZWwvQ29uZmlnLnBtIjsKICAgICRTZWxmLT57U1NPeDUwOUNlcnR9ID0gJENvbmZpZ09iamVjdC0+R2V0KCAnQXV0aE1vZHVsZTo6U0FNTDJTUDo6U1NPeDUwOUNlcnQnIC4gJFBhcmFte0NvdW50fSApIHx8IGRpZSAiTmVlZCBBdXRoTW9kdWxlOjpTQU1MMlNQOjpTU094NTA5Q2VydHtDb3VudH0gaW4gS2VybmVsL0NvbmZpZy5wbSI7CgoKICAgIHJldHVybiAkU2VsZjsKfQoKCnN1YiBHZXRPcHRpb24gewogICAgbXkgKCAkU2VsZiwgJVBhcmFtICkgPSBAXzsKCiAgICAjIGNoZWNrIG5lZWRlZCBzdHVmZgogICAgaWYgKCAhJFBhcmFte1doYXR9ICkgewogICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKAogICAgICAgICAgICBQcmlvcml0eSA9PiAnZXJyb3InLAogICAgICAgICAgICBNZXNzYWdlICA9PiAiTmVlZCBXaGF0ISIKICAgICAgICApOwogICAgICAgIHJldHVybjsKICAgIH0KCiAgICAjIG1vZHVsZSBvcHRpb25zCiAgICBteSAlT3B0aW9uID0gKAogICAgICAgIFByZUF1dGggPT4gMCwKICAgICk7CgogICAgIyByZXR1cm4gb3B0aW9uCiAgICByZXR1cm4gJE9wdGlvbnsgJFBhcmFte1doYXR9IH07Cn0KCnN1YiBBdXRoIHsKICAgIG15ICggJFNlbGYsICVQYXJhbSApID0gQF87CiAgICAKICAgIG15ICRQYXJhbU9iamVjdCAgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6V2ViOjpSZXF1ZXN0Jyk7CiAgICAKICAgIG15ICR3YW50U2FtbFJlcXVlc3QgPSAkUGFyYW1PYmplY3QtPkdldFBhcmFtKCBQYXJhbSA9PiAnV2FudFNBTUxSZXF1ZXN0JyApOwoJbXkgJHNhbWxSZXNwb25zZSA9ICRQYXJhbU9iamVjdC0+R2V0UGFyYW0oIFBhcmFtID0+ICdTQU1MUmVzcG9uc2UnICk7CiAgICAKICAgIAogICAgbXkgJGNvbmZpZyA9IEtlcm5lbDo6U3lzdGVtOjpBdXRoOjpTQU1MMlNQOjpDb25maWctPm5ldyhDR0ktPm5ldygpKTsKICAgICRjb25maWctPntpZHBfc3NvX3RhcmdldF91cmx9ID0gJFNlbGYtPntTU09JZHBVcmx9OwoJJGNvbmZpZy0+e2Fzc2VydGlvbl9jb25zdW1lcl9zZXJ2aWNlX3VybH0gPSAiJEVOVntSRVFVRVNUX1NDSEVNRX06Ly8kRU5We0hUVFBfSE9TVH0vIiAuICRTZWxmLT57U1NPQXNzZXJ0aW9uQ29uc3VtZXJVUkx9OwoJJGNvbmZpZy0+e1NTT3g1MDlDZXJ0fSA9ICRTZWxmLT57U1NPeDUwOUNlcnR9OwoJCgkKICAgIGlmKCAhIGRlZmluZWQgJHNhbWxSZXNwb25zZSB8fCAkc2FtbFJlc3BvbnNlIGVxICIiICl7CgoJCSMgVGhpcyBwYWdlIGNhbGwgaXMgbm90IHRyaWdnZXJlZCBieSBhbiBzYW1sIHJlc3BvbnNlLiBXZSB3aWxsIGNyZWF0ZSBhbiBzYW1sIHJlcXVlc3Qgb25seSBpZiBpdCB3YXMgZXhwbGljaXRlbHkgcmVxdWVzdGVkCgkJaWYoIGRlZmluZWQgJHdhbnRTYW1sUmVxdWVzdCl7CgkJCW15ICRyZXF1ZXN0ID0gS2VybmVsOjpTeXN0ZW06OkF1dGg6OlNBTUwyU1A6OkF1dGhSZXF1ZXN0LT5uZXcoJGNvbmZpZyk7CgkJCW15ICRpZHBfcmVkaXJlY3QgPSAkcmVxdWVzdC0+Y3JlYXRlKCkuIiZSZXR1cm5VUkw9Ii4kY29uZmlnLT57YXNzZXJ0aW9uX2NvbnN1bWVyX3NlcnZpY2VfdXJsfTsKCQkJcHJpbnQgQ0dJOjpyZWRpcmVjdCgkaWRwX3JlZGlyZWN0KTsKCQl9ZWxzZXsKCQkJcmV0dXJuOwoJCX0KCQkKCX1lbHNlewoJCW15ICRyZXNwb25zZSA9IEtlcm5lbDo6U3lzdGVtOjpBdXRoOjpTQU1MMlNQOjpSZXNwb25zZS0+bmV3KCRzYW1sUmVzcG9uc2UsICRjb25maWcpOwoJCQoJCWlmKCRyZXNwb25zZS0+aXNfdmFsaWQoKSl7CgkJCXJldHVybiAkcmVzcG9uc2UtPmdldF9hdHRyaWJ1dGUoJFNlbGYtPntTU09Vc2VySWRBdHRyaWJ1dGV9KTsKCQl9ZWxzZXsKCQkJJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coCgkgICAgICAgICAgICBQcmlvcml0eSA9PiAnZXJyb3InLAoJICAgICAgICAgICAgTWVzc2FnZSAgPT4gIlJlY2VpdmVkIGFuIFNBTUwgcmVzcG9uc2Ugd2l0aCBhIHdyb25nIHNpZ25hdHVyZSEiCiAgICAgICAgCSk7CiAgICAgICAgCgkJCXJldHVybjsKCQl9CgkJCgkJCgl9CiAgICAKICAgIAogICAgCglyZXR1cm47Cn0KCjE7</File>
        <File Location="Kernel/System/Auth/SAML2SP/AuthRequest.pm" Permission="644" Encode="Base64">IyAtLQojIEtlcm5lbDo6U3lzdGVtOjpBdXRoOjpTQU1MMlNQOjpBdXRoUmVxdWVzdC5wbSAtIGF1dGhlbnRpY2F0aW9uIG1vZHVsZQojIENvcHlyaWdodCAoQykgKDIwMTYpIChNYXhpbWUgQXBwb2xvbmlhKSAobWF4aW1lLmFwcG9sb25pYUByZXN0ZW5hLmx1KQojIC0tCiMgVGhpcyBzb2Z0d2FyZSBjb21lcyB3aXRoIEFCU09MVVRFTFkgTk8gV0FSUkFOVFkuIEZvciBkZXRhaWxzLCBzZWUKIyB0aGUgZW5jbG9zZWQgZmlsZSBDT1BZSU5HIGZvciBsaWNlbnNlIGluZm9ybWF0aW9uIChBR1BMKS4gSWYgeW91CiMgZGlkIG5vdCByZWNlaXZlIHRoaXMgZmlsZSwgc2VlIGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9hZ3BsLnR4dC4KIyAtLQoKcGFja2FnZSBLZXJuZWw6OlN5c3RlbTo6QXV0aDo6U0FNTDJTUDo6QXV0aFJlcXVlc3Q7Cgp1c2Ugc3RyaWN0Owp1c2Ugd2FybmluZ3M7Cgp1c2UgRGF0ZVRpbWU7CnVzZSBNSU1FOjpCYXNlNjQ7CnVzZSBDb21wcmVzczo6WmxpYjsKdXNlIFVSSTo6RXNjYXBlOwoKCnN1YiBuZXd7CglteSAkY2xhc3MgPSBzaGlmdDsKCW15ICggJHNldHRpbmdzICkgPSBAXzsgCgkKCW15ICRzZWxmID0gYmxlc3MgewoJCXNldHRpbmdzID0+ICRzZXR0aW5ncyAKCX0sICRjbGFzczsgCgkKCXJldHVybiAkc2VsZjsKfQoKc3ViIGNyZWF0ZXsKCW15ICRzZWxmID0gc2hpZnQ7CgkKCQogICAgCglteSAkaWQgPSAkc2VsZi0+Z2VuZXJhdGVVbmlxdWVJRCgyMCk7CglteSAkaXNzdWVfaW5zdGFudCA9ICRzZWxmLT5nZXRUaW1lU3RhbXAoKTsKCiAgICBteSAkcmVxdWVzdCA9ICI8c2FtbHA6QXV0aG5SZXF1ZXN0IHhtbG5zOnNhbWxwPVwidXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOnByb3RvY29sXCIgSUQ9XCIkaWRcIiBWZXJzaW9uPVwiMi4wXCIgSXNzdWVJbnN0YW50PVwiJGlzc3VlX2luc3RhbnRcIiBQcm90b2NvbEJpbmRpbmc9XCJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YmluZGluZ3M6SFRUUC1QT1NUXCIgQXNzZXJ0aW9uQ29uc3VtZXJTZXJ2aWNlVVJMPVwiIi4kc2VsZi0+e3NldHRpbmdzfS0+e2Fzc2VydGlvbl9jb25zdW1lcl9zZXJ2aWNlX3VybH0uIlwiPiIuCiAgICAgICAgICAgICI8c2FtbDpJc3N1ZXIgeG1sbnM6c2FtbD1cInVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphc3NlcnRpb25cIj4iLiRzZWxmLT57c2V0dGluZ3N9LT57aXNzdWVyfS4iPC9zYW1sOklzc3Vlcj5cbiIuCiAgICAgICAgICAgICI8c2FtbHA6TmFtZUlEUG9saWN5IHhtbG5zOnNhbWxwPVwidXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOnByb3RvY29sXCIgRm9ybWF0PVwiJHNlbGYtPntzZXR0aW5nc30tPntuYW1lX2lkZW50aWZpZXJfZm9ybWF0fVwiIEFsbG93Q3JlYXRlPVwidHJ1ZVwiPjwvc2FtbHA6TmFtZUlEUG9saWN5PlxuIi4KICAgICAgICAgICAgIjwvc2FtbHA6QXV0aG5SZXF1ZXN0PiI7CgkKCQoJbXkgJGRlZmxhdGVkX3JlcXVlc3QgID0gY29tcHJlc3MoJHJlcXVlc3QpOwoJJGRlZmxhdGVkX3JlcXVlc3QgPSBzdWJzdHIoJGRlZmxhdGVkX3JlcXVlc3QsIDIsIGxlbmd0aCgkZGVmbGF0ZWRfcmVxdWVzdCktNCk7ICMgcGhwIGluZmxhdGUgZG9lcyBub3QgbGlrZSBmaXJzdCAyIGJ5dGVzIGFuZCBsYXN0IDR0aCA/IT8KCQoJCglteSAkYmFzZTY0X3JlcXVlc3QgPSBlbmNvZGVfYmFzZTY0KCRkZWZsYXRlZF9yZXF1ZXN0KTsKCQoJbXkgJGVuY29kZWRfcmVxdWVzdCA9IHVyaV9lc2NhcGUoJGJhc2U2NF9yZXF1ZXN0KTsKCQogICAgcmV0dXJuICRzZWxmLT57c2V0dGluZ3N9LT57aWRwX3Nzb190YXJnZXRfdXJsfS4iP1NBTUxSZXF1ZXN0PSIuJGVuY29kZWRfcmVxdWVzdDsKfQoKCnN1YiBnZW5lcmF0ZVVuaXF1ZUlEewoJbXkgJHNlbGYgPSBzaGlmdDsKCW15ICggJGxlbmd0aCApID0gQF87CgkKCW15ICRjaGFycyA9ICJhYmNkZWYwMTIzNDU2Nzg5IjsKICAgIG15ICRjaGFyc19sZW4gPSBsZW5ndGgoJGNoYXJzKTsKICAgIG15ICR1bmlxdWVJRCA9ICIiOwogICAgZm9yIChteSAkaSA9IDA7ICRpIDwgJGxlbmd0aDsgJGkrKyl7CiAgICAJJHVuaXF1ZUlEIC49IHN1YnN0cigkY2hhcnMscmFuZCgkY2hhcnNfbGVuKSwxKTsKICAgIH0KICAgIHJldHVybiAiXyIuJHVuaXF1ZUlEOwp9CgoKc3ViIGdldFRpbWVTdGFtcHsKCW15ICRzZWxmID0gc2hpZnQ7CgkKICAgIG15ICRkdCA9IERhdGVUaW1lLT5ub3coKTsKICAgIHJldHVybiAkZHQtPnN0cmZ0aW1lKCIlWS0lbS0lZFQlSDolTTolU1oiKTsKfQoKMTs=</File>
        <File Location="Kernel/System/Auth/SAML2SP/Config.pm" Permission="644" Encode="Base64">IyAtLQojIEtlcm5lbDo6U3lzdGVtOjpBdXRoOjpTQU1MMlNQOjpDb25maWcucG0gLSBhdXRoZW50aWNhdGlvbiBtb2R1bGUKIyBDb3B5cmlnaHQgKEMpICgyMDE2KSAoTWF4aW1lIEFwcG9sb25pYSkgKG1heGltZS5hcHBvbG9uaWFAcmVzdGVuYS5sdSkKIyAtLQojIFRoaXMgc29mdHdhcmUgY29tZXMgd2l0aCBBQlNPTFVURUxZIE5PIFdBUlJBTlRZLiBGb3IgZGV0YWlscywgc2VlCiMgdGhlIGVuY2xvc2VkIGZpbGUgQ09QWUlORyBmb3IgbGljZW5zZSBpbmZvcm1hdGlvbiAoQUdQTCkuIElmIHlvdQojIGRpZCBub3QgcmVjZWl2ZSB0aGlzIGZpbGUsIHNlZSBodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvYWdwbC50eHQuCiMgLS0KCnBhY2thZ2UgS2VybmVsOjpTeXN0ZW06OkF1dGg6OlNBTUwyU1A6OkNvbmZpZzsKCnVzZSBzdHJpY3Q7CnVzZSB3YXJuaW5nczsKCgpzdWIgbmV3ewoJbXkgJGNsYXNzID0gc2hpZnQ7CglteSAoICRjZ2kgKSA9IEBfOyAKCQoJbXkgJHNlbGYgPSBibGVzcyB7CgkJaWRwX3Nzb190YXJnZXRfdXJsID0+ICIiLAoJCXg1MDljZXJ0aWZpY2F0ZSA9PiAiIiwKCQlhc3NlcnRpb25fY29uc3VtZXJfc2VydmljZV91cmwgPT4gJGNnaS0+dXJsKCksCgkJaXNzdWVyID0+ICIkRU5We1JFUVVFU1RfU0NIRU1FfTovLyRFTlZ7SFRUUF9IT1NUfS8iLAoJCW5hbWVfaWRlbnRpZmllcl9mb3JtYXQgPT4gInVybjpvYXNpczpuYW1lczp0YzpTQU1MOjEuMTpuYW1laWQtZm9ybWF0OmVtYWlsQWRkcmVzcyIKCX0sICRjbGFzczsgCgkKCXJldHVybiAkc2VsZjsKfQoKMTs=</File>
        <File Location="Kernel/System/Auth/SAML2SP/Response.pm" Permission="644" Encode="Base64">IyAtLQojIEtlcm5lbDo6U3lzdGVtOjpBdXRoOjpTQU1MMlNQOjpSZXNwb25zZS5wbSAtIGF1dGhlbnRpY2F0aW9uIG1vZHVsZQojIENvcHlyaWdodCAoQykgKDIwMTYpIChNYXhpbWUgQXBwb2xvbmlhKSAobWF4aW1lLmFwcG9sb25pYUByZXN0ZW5hLmx1KQojIC0tCiMgVGhpcyBzb2Z0d2FyZSBjb21lcyB3aXRoIEFCU09MVVRFTFkgTk8gV0FSUkFOVFkuIEZvciBkZXRhaWxzLCBzZWUKIyB0aGUgZW5jbG9zZWQgZmlsZSBDT1BZSU5HIGZvciBsaWNlbnNlIGluZm9ybWF0aW9uIChBR1BMKS4gSWYgeW91CiMgZGlkIG5vdCByZWNlaXZlIHRoaXMgZmlsZSwgc2VlIGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9hZ3BsLnR4dC4KIyAtLQoKcGFja2FnZSBLZXJuZWw6OlN5c3RlbTo6QXV0aDo6U0FNTDJTUDo6UmVzcG9uc2U7Cgp1c2Ugc3RyaWN0Owp1c2Ugd2FybmluZ3M7Cgp1c2UgRGF0YTo6RHVtcGVyOwp1c2UgRGF0ZVRpbWU7CnVzZSBEYXRlVGltZTo6Rm9ybWF0OjpEYXRlUGFyc2U7CnVzZSBNSU1FOjpCYXNlNjQ7CnVzZSBYTUw6OkxpYlhNTDsKdXNlIERpZ2VzdDo6U0hBIHF3KHNoYTFfYmFzZTY0IHNoYTI1Nl9iYXNlNjQgc2hhNTEyX2Jhc2U2NCk7CnVzZSBDcnlwdDo6T3BlblNTTDo6UlNBOwp1c2UgQ3J5cHQ6Ok9wZW5TU0w6Olg1MDk7CgpzdWIgbmV3ewoJbXkgJGNsYXNzID0gc2hpZnQ7CglteSAoICRyYXdfcmVzcG9uc2UsICRzZXR0aW5ncyApID0gQF87IAoJCglteSAkc2VsZiA9IGJsZXNzIHsKCQlyYXdfcmVzcG9uc2UgPT4gJHJhd19yZXNwb25zZSwKCQlzZXR0aW5ncyA9PiAkc2V0dGluZ3MsCgkJeG1sX2FzX2RvbSA9PiAiIiwKCQlzaWduYXR1cmVfbm9kZSA9PiAiIiwKCQlzaWduZWRJbmZvID0+ICIiLAoJCXZhbGlkYXRlZF9ub2RlcyA9PiB1bmRlZiwKCQlzaWduZWRfaW5mbyA9PiAiIiwKCQlrZXlfc2lnbl9hbGdvID0+ICIiCgl9LCAkY2xhc3M7IAoJCgkkc2VsZi0+ZGVjb2RlKCk7CgkKCXJldHVybiAkc2VsZjsKfQoKCnN1YiBkZWNvZGV7CglteSAkc2VsZiA9IHNoaWZ0OwoJCgkkc2VsZi0+e3htbF9hc19zdHJpbmd9ID0gZGVjb2RlX2Jhc2U2NCgkc2VsZi0+e3Jhd19yZXNwb25zZX0pOwoJCglteSAkcGFyc2VyID0gWE1MOjpMaWJYTUwtPm5ldygpOwoJJHNlbGYtPnt4bWxfYXNfZG9tfSA9ICRwYXJzZXItPnBhcnNlX3N0cmluZygkc2VsZi0+e3htbF9hc19zdHJpbmd9KTsKfQoKc3ViIGlzX3ZhbGlkewoJbXkgJHNlbGYgPSBzaGlmdDsKCQoJaWYoISRzZWxmLT52YWxpZGF0ZU51bUFzc2VydGlvbnMoKSl7CgkJJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coUHJpb3JpdHkgPT4gJ2Vycm9yJywgTWVzc2FnZSAgPT4gIlNBTUw6IG5vIG9yIG1vcmUgdGhhbiBvbmUgc2FtbCBhc3NlcnRpb24gaW4gdGhlIHJlc3BvbnNlLCBuZWVkIG9ubHkgb25lIik7CgkJcmV0dXJuOwoJfQoJCglpZighJHNlbGYtPnZhbGlkYXRlVGltZXN0YW1wcygpKXsKCQkkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZyhQcmlvcml0eSA9PiAnZXJyb3InLCBNZXNzYWdlICA9PiAiU0FNTDogdGltZXN0YW1wcyBkbyBub3QgbWF0Y2giKTsKCQlyZXR1cm47Cgl9CgkKCWlmKCEkc2VsZi0+dmFsaWRhdGVUaW1lc3RhbXBzKCkpewoJCSRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKFByaW9yaXR5ID0+ICdlcnJvcicsIE1lc3NhZ2UgID0+ICJTQU1MOiB0aW1lc3RhbXBzIGRvIG5vdCBtYXRjaCIpOwoJCXJldHVybjsKCX0KCQoJCglteSAkc2lnbmF0dXJlID0gJHNlbGYtPmdldF9zaWduYXR1cmUoKTsKCWlmKCEkc2lnbmF0dXJlKXsKCQkkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZyhQcmlvcml0eSA9PiAnZXJyb3InLCBNZXNzYWdlICA9PiAiU0FNTDogbm8gZGlnaXRhbCBzaWduYXR1cmUgZm91bmQiKTsKCQlyZXR1cm47Cgl9CgkjJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coUHJpb3JpdHkgPT4gJ2Vycm9yJywgTWVzc2FnZSAgPT4gIkRFQlVHOiAiLiRzaWduYXR1cmUpOwoJCgkkc2VsZi0+e3NpZ25lZF9pbmZvfSA9ICRzZWxmLT5jYW5vbmljYWxpemVTaWduZWRJbmZvKCk7CgkKCWlmKCEkc2VsZi0+dmFsaWRhdGVfcmVmZXJlbmNlKCkpewoJCSRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKFByaW9yaXR5ID0+ICdlcnJvcicsIE1lc3NhZ2UgID0+ICJTQU1MOiBkaWdlc3QgaXMgbm90IHZhbGlkIG9yIHdhcyBub3QgZm91bmQiKTsKCQlyZXR1cm47Cgl9CgkKCW15ICRvYmpLZXkgPSAkc2VsZi0+bG9jYXRlS2V5KCk7CiAgICBpZighICRvYmpLZXkgKSB7CiAgICAgICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coUHJpb3JpdHkgPT4gJ2Vycm9yJywgTWVzc2FnZSAgPT4gIlNBTUw6IFdlIGhhdmUgbm8gaWRlYSBhYm91dCB0aGUga2V5Iik7CiAgICAgICAgcmV0dXJuOwogICAgfQoJCglpZighJHNlbGYtPnZlcmlmeV9zaWduYXR1cmUoKSl7CgkJJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coUHJpb3JpdHkgPT4gJ2Vycm9yJywgTWVzc2FnZSAgPT4gIlNBTUw6IFNpZ25hdHVyZSB2ZXJpZmljYXRpb24gZmFpbGVkICEiKTsKCQlyZXR1cm47CQkKCX0KCQoJcmV0dXJuIDE7Cn0KCgpzdWIgZ2V0X3NpZ25hdHVyZXsKCW15ICRzZWxmID0gc2hpZnQ7CgkKCW15ICR4cGF0aCA9IFhNTDo6TGliWE1MOjpYUGF0aENvbnRleHQtPm5ldygkc2VsZi0+e3htbF9hc19kb219KTsKCSR4cGF0aC0+cmVnaXN0ZXJOcygic2VjZHNpZyIsICJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjIik7CglteSAkcXVlcnkgPSAiLi8vc2VjZHNpZzpTaWduYXR1cmUiOwoJbXkgQG5vZGVzID0gJHhwYXRoLT5maW5kbm9kZXMoJHF1ZXJ5KTsKCSRzZWxmLT57c2lnbmF0dXJlX25vZGV9ID0gJG5vZGVzWzBdOyAKCXJldHVybiAkbm9kZXNbMF07Cn0KCnN1YiBjYW5vbmljYWxpemVTaWduZWRJbmZvKCkgewoJbXkgJHNlbGYgPSBzaGlmdDsKCQogICAgbXkgJGNhbm9uaWNhbG1ldGhvZCA9IHVuZGVmOwogICAgCiAgICBteSAkeHBhdGggPSBYTUw6OkxpYlhNTDo6WFBhdGhDb250ZXh0LT5uZXcoJHNlbGYtPntzaWduYXR1cmVfbm9kZX0pOwogICAgJHhwYXRoLT5yZWdpc3Rlck5zKCJzZWNkc2lnIiwgImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyMiKTsKICAgIG15ICRxdWVyeSA9ICIuL3NlY2RzaWc6U2lnbmVkSW5mbyI7CiAgICBteSBAbm9kZXMgPSAkeHBhdGgtPmZpbmRub2RlcygkcXVlcnkpOwogICAgbXkgJHNpZ25JbmZvTm9kZSA9ICRub2Rlc1swXTsKICAgIGlmICgkc2lnbkluZm9Ob2RlKSB7CiAgICAJbXkgJHhwYXRoMiA9IFhNTDo6TGliWE1MOjpYUGF0aENvbnRleHQtPm5ldygkc2lnbkluZm9Ob2RlKTsKCSAgICAkeHBhdGgyLT5yZWdpc3Rlck5zKCJzZWNkc2lnIiwgImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyMiKTsKCSAgICBteSAkcXVlcnkyID0gIi4vc2VjZHNpZzpDYW5vbmljYWxpemF0aW9uTWV0aG9kIjsKCSAgICBteSBAbm9kZXMyID0gJHhwYXRoMi0+ZmluZG5vZGVzKCRxdWVyeTIpOwogICAgICAgIG15ICRjYW5vbk5vZGUgPSAkbm9kZXMyWzBdOyAgCiAgICAgICAgbXkgQGF0dHIgPSAkY2Fub25Ob2RlLT5hdHRyaWJ1dGVzKCk7CiAgICAgICAgbXkgJGNhbm9uaWNhbG1ldGhvZDsKICAgICAgICBmb3IobXkgJGo9MDsgJGogPCBzY2FsYXIoQGF0dHIpIDsgJGorKyl7CiAgICAJCWlmKCRhdHRyWyRqXS0+bm9kZU5hbWUgZXEgIkFsZ29yaXRobSIpewogICAgCQkJJGNhbm9uaWNhbG1ldGhvZCA9ICRhdHRyWyRqXS0+dmFsdWU7CQogICAgCQl9CiAgICAgICAgfQogICAgICAgICRzZWxmLT57c2lnbmVkSW5mb30gPSAkc2VsZi0+Y2Fub25pY2FsaXplRGF0YSgkc2lnbkluZm9Ob2RlLCAkY2Fub25pY2FsbWV0aG9kKTsKICAgICAgICAjJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coUHJpb3JpdHkgPT4gJ2Vycm9yJywgTWVzc2FnZSAgPT4gIkRFQlVHOiAiLkR1bXBlcigkc2VsZi0+e3NpZ25lZEluZm99KSk7CiAgICAgICAgcmV0dXJuICRzZWxmLT57c2lnbmVkSW5mb307CiAgICB9CiAgICByZXR1cm47Cn0KCnN1YiBjYW5vbmljYWxpemVEYXRhewoJbXkgJHNlbGYgPSBzaGlmdDsKCW15ICggJG5vZGUsICRjYW5vbmljYWxtZXRob2QgKSA9IEBfOyAKCQoJbXkgJGV4Y2x1c2l2ZSA9IDA7CiAgICBteSAkd2l0aENvbW1lbnRzID0gMDsKICAgIGlmICgkY2Fub25pY2FsbWV0aG9kIGVxICJodHRwOi8vd3d3LnczLm9yZy9UUi8yMDAxL1JFQy14bWwtYzE0bi0yMDAxMDMxNSIpIHsgICAgCiAgICAgICAgJGV4Y2x1c2l2ZSA9IDA7CiAgICAgICAgJHdpdGhDb21tZW50cyA9IDA7CiAgICB9CiAgICAKICAgIGlmICgkY2Fub25pY2FsbWV0aG9kIGVxICJodHRwOi8vd3d3LnczLm9yZy9UUi8yMDAxL1JFQy14bWwtYzE0bi0yMDAxMDMxNSNXaXRoQ29tbWVudHMiKSB7CiAgICAgICAgJHdpdGhDb21tZW50cyA9IDE7CiAgICB9CiAgICAKICAgIGlmICgkY2Fub25pY2FsbWV0aG9kIGVxICJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzEwL3htbC1leGMtYzE0biMiKSB7CiAgICAgICAgJGV4Y2x1c2l2ZSA9IDE7CiAgICB9CiAgICAKICAgIGlmICgkY2Fub25pY2FsbWV0aG9kIGVxICJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzEwL3htbC1leGMtYzE0biNXaXRoQ29tbWVudHMiKSB7CiAgICAgICAgJGV4Y2x1c2l2ZSA9IDE7CiAgICAgICAgJHdpdGhDb21tZW50cyA9IDE7CiAgICB9CiAgICAKICAgIGlmKCRleGNsdXNpdmUpewogICAgCXJldHVybiAkbm9kZS0+dG9TdHJpbmdFQzE0Tigkd2l0aENvbW1lbnRzKTsKICAgIH1lbHNlewogICAgCXJldHVybiAkbm9kZS0+dG9TdHJpbmdDMTROKCR3aXRoQ29tbWVudHMpCiAgICB9CiAgICAKICAgIHJldHVybjsKfQoKc3ViIHZhbGlkYXRlX3JlZmVyZW5jZXsKCW15ICRzZWxmID0gc2hpZnQ7CgoKCQogICAgaWYgKCEkc2VsZi0+e3htbF9hc19kb219LT5pc1NhbWVOb2RlKCRzZWxmLT57c2lnbmF0dXJlX25vZGV9KSkgewogICAgICAgICRzZWxmLT57c2lnbmF0dXJlX25vZGV9LT5wYXJlbnROb2RlLT5yZW1vdmVDaGlsZCgkc2VsZi0+e3NpZ25hdHVyZV9ub2RlfSk7CiAgICB9CgoJCglteSAkeHBhdGggPSBYTUw6OkxpYlhNTDo6WFBhdGhDb250ZXh0LT5uZXcoJHNlbGYtPntzaWduYXR1cmVfbm9kZX0pOwogICAgJHhwYXRoLT5yZWdpc3Rlck5zKCJzZWNkc2lnIiwgImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyMiKTsKICAgIG15ICRxdWVyeSA9ICIuL3NlY2RzaWc6U2lnbmVkSW5mby9zZWNkc2lnOlJlZmVyZW5jZSI7CiAgICBteSBAbm9kZXMgPSAkeHBhdGgtPmZpbmRub2RlcygkcXVlcnkpOwogICAgaWYoc2NhbGFyKEBub2Rlcyk9PTApewogICAgCXJldHVybjsKICAgIH0KICAgIAogICAgJHNlbGYtPnt2YWxpZGF0ZWRfbm9kZXN9ID0gKCk7CiAgICAgCiAgICBmb3IobXkgJGk9MDsgJGkgPCBzY2FsYXIoQG5vZGVzKTsgJGkrKykgewogICAgCWlmKCEkc2VsZi0+cHJvY2Vzc1JlZk5vZGUoJG5vZGVzWyRpXSkpewogICAgCQkkc2VsZi0+e3ZhbGlkYXRlZF9ub2Rlc30gPSAoKTsKICAgIAkJcmV0dXJuOwkJCiAgICAJfQogICAgfQogICAgCiAgICByZXR1cm4gMTsKCn0KCnN1YiBwcm9jZXNzUmVmTm9kZXsKCW15ICRzZWxmID0gc2hpZnQ7CglteSAoICRyZWZfbm9kZSApID0gQF87CgkKCSMkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZyhQcmlvcml0eSA9PiAnZXJyb3InLCBNZXNzYWdlICA9PiAiU0FNTCBERUJVRzogIi4gJHJlZl9ub2RlKTsKCW15IEBhdHRyID0gJHJlZl9ub2RlLT5hdHRyaWJ1dGVzKCk7CiAgICBteSAkbm9kZV9pZCA9ICIiOwogICAgZm9yKG15ICRqPTA7ICRqIDwgc2NhbGFyKEBhdHRyKSA7ICRqKyspewogICAgCWlmKCRhdHRyWyRqXS0+bm9kZU5hbWUgZXEgIlVSSSIpewogICAgCQkkbm9kZV9pZCA9ICRhdHRyWyRqXS0+dmFsdWU7CiAgICAJCWlmKCEoc3Vic3RyKCRub2RlX2lkLCAwLCAxKSBlcSAiIyIpKXsKICAgIAkJCSMgZXh0ZXJuYWwgdXJsIG5vdCBzdXBwb3J0ZWQKICAgIAkJCXJldHVybjsKICAgIAkJfQogICAgCQkkbm9kZV9pZCA9IHN1YnN0cigkbm9kZV9pZCwgMSwgbGVuZ3RoKCRub2RlX2lkKSk7CiAgICAJCSMkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZyhQcmlvcml0eSA9PiAnZXJyb3InLCBNZXNzYWdlICA9PiAiU0FNTCBERUJVRzogIi4gJG5vZGVfaWQpOwogICAgCX0KICAgIH0KCQoJbXkgJHhwYXRoID0gWE1MOjpMaWJYTUw6OlhQYXRoQ29udGV4dC0+bmV3KCRzZWxmLT57eG1sX2FzX2RvbX0pOwoJJHhwYXRoLT5yZWdpc3Rlck5zKCJzYW1scCIsICJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6cHJvdG9jb2wiKTsKCSR4cGF0aC0+cmVnaXN0ZXJOcygic2FtbCIsICJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXNzZXJ0aW9uIik7CglteSAkcXVlcnkgPSAnLy8qW0BJRD0iJy4gJG5vZGVfaWQgLiciXSc7CglteSBAbm9kZXMgPSAkeHBhdGgtPmZpbmRub2RlcygkcXVlcnkpOwoJIyRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKFByaW9yaXR5ID0+ICdlcnJvcicsIE1lc3NhZ2UgPT4gIlNBTUwgREVCVUc6ICIuIER1bXBlcigkbm9kZXNbMF0pKTsKCQoJbXkgJGRhdGFPYmplY3QgPSAkbm9kZXNbMF07CgkKCWlmKCEkc2VsZi0+dmFsaWRhdGVEaWdlc3QoJHJlZl9ub2RlLCAkZGF0YU9iamVjdCkpewoJCXJldHVybjsKCX0KCQoJJHNlbGYtPnt2YWxpZGF0ZWRfbm9kZXN9eyRub2RlX2lkfSA9ICRkYXRhT2JqZWN0OyAKCQoJcmV0dXJuIDE7CgkKfQoKCgoKc3ViIHZhbGlkYXRlRGlnZXN0KCl7CglteSAkc2VsZiA9IHNoaWZ0OwoJbXkgKCAkcmVmX25vZGUsICRkYXRhX29iamVjdCApID0gQF87CgkKCW15ICR4cGF0aCA9IFhNTDo6TGliWE1MOjpYUGF0aENvbnRleHQtPm5ldygkcmVmX25vZGUpOwoJJHhwYXRoLT5yZWdpc3Rlck5zKCJzZWNkc2lnIiwgImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyMiKTsKCW15ICRxdWVyeSA9ICcuL3NlY2RzaWc6RGlnZXN0TWV0aG9kL0BBbGdvcml0aG0nOwoJbXkgQG5vZGVzID0gJHhwYXRoLT5maW5kbm9kZXMoJHF1ZXJ5KTsKCW15ICRkaWdlc3RBbGdvcml0aG0gPSAkbm9kZXNbMF0tPnRleHRDb250ZW50OwoJCglteSAkZGF0YSA9ICRzZWxmLT5wcm9jZXNzVHJhbnNmb3JtcygkcmVmX25vZGUsICRkYXRhX29iamVjdCk7CglteSAkY2FsY3VsYXRlZERpZ1ZhbHVlID0gJHNlbGYtPmNhbGN1bGF0ZURpZ2VzdCgkZGlnZXN0QWxnb3JpdGhtLCAkZGF0YSk7CiAgICAKICAgICMgcmVtb3ZlID0gcGFkZG5nIGNoYXJhY3RlcnMKICAgICRjYWxjdWxhdGVkRGlnVmFsdWUgPX4gcy9cbi8vZzsKICAgIAogICAgbXkgJHF1ZXJ5MiA9ICIuL3NlY2RzaWc6RGlnZXN0VmFsdWUiOwogICAgbXkgQG5vZGVzMiA9ICR4cGF0aC0+ZmluZG5vZGVzKCRxdWVyeTIsICRyZWZfbm9kZSk7CiAgICBteSAkZGlnZXN0VmFsdWUgPSAkbm9kZXMyWzBdLT50ZXh0Q29udGVudDsKICAgIAogICAgIyByZW1vdmUgPSBwYWRkbmcgY2hhcmFjdGVycwogICAgJGRpZ2VzdFZhbHVlID1+IHMvXD0vL2c7CiAgICAKCSMkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZyhQcmlvcml0eSA9PiAnZXJyb3InLCBNZXNzYWdlID0+ICItLS0iLiAkZGF0YSAuICItLS0iKTsKCQoJIyRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKFByaW9yaXR5ID0+ICdlcnJvcicsIE1lc3NhZ2UgPT4gIlNBTUwgREVCVUc6IHZhbCBoYXNoIGlzICIuICRjYWxjdWxhdGVkRGlnVmFsdWUpOwoJIyRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKFByaW9yaXR5ID0+ICdlcnJvcicsIE1lc3NhZ2UgPT4gIlNBTUwgREVCVUc6IHhtbCBoYXNoIGlzICIuICRkaWdlc3RWYWx1ZSk7CiAgICAKCQoJaWYoJGNhbGN1bGF0ZWREaWdWYWx1ZSAgZXEgJGRpZ2VzdFZhbHVlKXsKCQkjJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coUHJpb3JpdHkgPT4gJ2Vycm9yJywgTWVzc2FnZSA9PiAiU0FNTCBERUJVRzogZGlnZXN0IGFyZSBtYXRjaGluZyIpOwoJCXJldHVybiAxOwoJfQkKCQoJIyRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKFByaW9yaXR5ID0+ICdlcnJvcicsIE1lc3NhZ2UgPT4gIlNBTUwgREVCVUc6IGRpZ2VzdCBhcmUgbm90IG1hdGNoaW5nIik7CglyZXR1cm47Cn0KCnN1YiBwcm9jZXNzVHJhbnNmb3JtcygpewoJbXkgJHNlbGYgPSBzaGlmdDsKCW15ICggJHJlZl9ub2RlLCAkZGF0YV9vYmplY3QgKSA9IEBfOwoJCglyZXR1cm4gJHNlbGYtPmNhbm9uaWNhbGl6ZURhdGEoJGRhdGFfb2JqZWN0LCAiaHR0cDovL3d3dy53My5vcmcvMjAwMS8xMC94bWwtZXhjLWMxNG4jIik7CgkKfQoKc3ViIGNhbGN1bGF0ZURpZ2VzdCgpewoJbXkgJHNlbGYgPSBzaGlmdDsKCW15ICggJGRpZ2VzdEFsZ29yaXRobSwgJGRhdGEgKSA9IEBfOwoJCglpZigkZGlnZXN0QWxnb3JpdGhtIGVxICJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjc2hhMSIpewoJCXJldHVybiBzaGExX2Jhc2U2NCgkZGF0YSk7Cgl9CgkKCWlmKCRkaWdlc3RBbGdvcml0aG0gZXEgImh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZW5jI3NoYTI1NiIpewoJCXJldHVybiBzaGEyNTZfYmFzZTY0KCRkYXRhKTsKCX0KCQoJaWYoJGRpZ2VzdEFsZ29yaXRobSBlcSAiaHR0cDovL3d3dy53My5vcmcvMjAwMS8wNC94bWxlbmMjc2hhNTEyIil7CgkJcmV0dXJuIHNoYTUxMl9iYXNlNjQoJGRhdGEpOwoJfQoJCglpZigkZGlnZXN0QWxnb3JpdGhtIGVxICJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGVuYyNyaXBlbWQxNjAiKXsKCQkkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZyhQcmlvcml0eSA9PiAnZXJyb3InLCBNZXNzYWdlID0+ICJTQU1MIGVycm9yOiByaXBlbWQxNjAgZGlnZXN0IG5vdCBzdXBwb3J0ZWQiKTsKCQlyZXR1cm47Cgl9CgkKCXJldHVybjsKfQoKCnN1YiBsb2NhdGVLZXkoKXsKCW15ICRzZWxmID0gc2hpZnQ7CgkKCQoJbXkgJHhwYXRoID0gWE1MOjpMaWJYTUw6OlhQYXRoQ29udGV4dC0+bmV3KCRzZWxmLT57c2lnbmF0dXJlX25vZGV9KTsKCSR4cGF0aC0+cmVnaXN0ZXJOcygic2VjZHNpZyIsICJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjIik7CglteSAkcXVlcnkgPSAnLi9zZWNkc2lnOlNpZ25lZEluZm8vc2VjZHNpZzpTaWduYXR1cmVNZXRob2QvQEFsZ29yaXRobSc7CglteSBAbm9kZXMgPSAkeHBhdGgtPmZpbmRub2RlcygkcXVlcnkpOwoJCgkKCW15ICRhbGdvcml0aG0gPSAkbm9kZXNbMF0tPnRleHRDb250ZW50OwogICAgaWYgKCRhbGdvcml0aG0pIHsKICAgIAkjJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coUHJpb3JpdHkgPT4gJ2Vycm9yJywgTWVzc2FnZSA9PiAiU0FNTCBERUJVRzogIi4kYWxnb3JpdGhtKTsKICAgIAkkc2VsZi0+e2tleV9zaWduX2FsZ299ID0gJGFsZ29yaXRobTsKICAgICAgICAjICRvYmpLZXkgPSBuZXcgWE1MU2VjdXJpdHlLZXkoJGFsZ29yaXRobSwgYXJyYXkoJ3R5cGUnPT4ncHVibGljJykpOwogICAgICAgICNyZXR1cm4gJG9iaktleTsKICAgIH0KCQp9CgpzdWIgdmVyaWZ5X3NpZ25hdHVyZSgpewoJbXkgJHNlbGYgPSBzaGlmdDsKCQoJbXkgJHhwYXRoID0gWE1MOjpMaWJYTUw6OlhQYXRoQ29udGV4dC0+bmV3KCRzZWxmLT57c2lnbmF0dXJlX25vZGV9KTsKCSR4cGF0aC0+cmVnaXN0ZXJOcygic2VjZHNpZyIsICJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjIik7CglteSAkcXVlcnkgPSAnLi9zZWNkc2lnOlNpZ25hdHVyZVZhbHVlJzsKCW15IEBub2RlcyA9ICR4cGF0aC0+ZmluZG5vZGVzKCRxdWVyeSk7CglteSAkc2lnVmFsdWUgPSBkZWNvZGVfYmFzZTY0KCRub2Rlc1swXS0+dGV4dENvbnRlbnQpOwoJCgkjJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coUHJpb3JpdHkgPT4gJ2Vycm9yJywgTWVzc2FnZSA9PiAiU0FNTCBERUJVRzogIi4gJHNlbGYtPntzZXR0aW5nc317U1NPeDUwOUNlcnR9KTsKCQoJbXkgJHg1MDkgPSBDcnlwdDo6T3BlblNTTDo6WDUwOS0+bmV3X2Zyb21fc3RyaW5nKCRzZWxmLT57c2V0dGluZ3N9e1NTT3g1MDlDZXJ0fSwgQ3J5cHQ6Ok9wZW5TU0w6Olg1MDk6OkZPUk1BVF9QRU0pOwoJbXkgJHB1YmtleSA9IENyeXB0OjpPcGVuU1NMOjpSU0EtPm5ld19wdWJsaWNfa2V5KCR4NTA5LT5wdWJrZXkoKSk7CgkkcHVia2V5LT51c2Vfc2hhMV9oYXNoKCk7CgoJbXkgJHZhbGlkID0gJHB1YmtleS0+dmVyaWZ5KCRzZWxmLT57c2lnbmVkX2luZm99LCAkc2lnVmFsdWUpOwoJCgkjJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coUHJpb3JpdHkgPT4gJ2Vycm9yJywgTWVzc2FnZSA9PiAiU0FNTCBERUJVRzogU2lnbmF0dXJlIGlzICIuJHZhbGlkKTsKCQoJcmV0dXJuICR2YWxpZDsKCQp9CgpzdWIgdmFsaWRhdGVOdW1Bc3NlcnRpb25zKCl7CglteSAkc2VsZiA9IHNoaWZ0OwogICAgCiAgICBteSBAYXNzZXJ0aW9uTm9kZXMgPSAkc2VsZi0+e3htbF9hc19kb219LT5nZXRFbGVtZW50c0J5VGFnTmFtZSgnc2FtbDpBc3NlcnRpb24nKTsKICAgIHJldHVybiAoc2NhbGFyKEBhc3NlcnRpb25Ob2RlcykgPT0gMSk7Cn0KCgpzdWIgdmFsaWRhdGVUaW1lc3RhbXBzKCl7CglteSAkc2VsZiA9IHNoaWZ0OwogICAgCiAgICBteSBAdGltZXN0YW1wTm9kZXMgPSAkc2VsZi0+e3htbF9hc19kb219LT5nZXRFbGVtZW50c0J5VGFnTmFtZSgnc2FtbDpDb25kaXRpb25zJyk7CiAgICBmb3IobXkgJGk9MDsgJGkgPCBzY2FsYXIoQHRpbWVzdGFtcE5vZGVzKSA7ICRpKyspewogICAgCW15IEBhdHRyID0gJHRpbWVzdGFtcE5vZGVzWyRpXS0+YXR0cmlidXRlcygpOwogICAgCQogICAgCWZvcihteSAkaj0wOyAkaiA8IHNjYWxhcihAYXR0cikgOyAkaisrKXsKICAgIAkJaWYoCiAgICAJCQkkYXR0clskal0tPm5vZGVOYW1lIGVxICJOb3RCZWZvcmUiICYmIAogICAgCQkJKERhdGVUaW1lOjpGb3JtYXQ6OkRhdGVQYXJzZS0+cGFyc2VfZGF0ZXRpbWUoJGF0dHJbJGpdLT52YWx1ZSkgLSBEYXRlVGltZS0+bm93KCkpLT5pc19wb3NpdGl2ZSgpICAgCiAgICAJCSl7CiAgICAJCQlyZXR1cm47CiAgICAJCX0KICAgIAkJaWYoCiAgICAJCQkkYXR0clskal0tPm5vZGVOYW1lIGVxICJOb3RPbk9yQWZ0ZXIiICYmIAogICAgCQkJIShEYXRlVGltZTo6Rm9ybWF0OjpEYXRlUGFyc2UtPnBhcnNlX2RhdGV0aW1lKCRhdHRyWyRqXS0+dmFsdWUpIC0gRGF0ZVRpbWUtPm5vdygpKS0+aXNfcG9zaXRpdmUoKSAgIAogICAgCQkpewogICAgCQkJcmV0dXJuOwogICAgCQl9CiAgICAJfQogICAgfQogICAgcmV0dXJuIDE7Cn0KCgpzdWIgZ2V0X25hbWVpZHsKCW15ICRzZWxmID0gc2hpZnQ7CgkKCW15ICR4cGF0aCA9IFhNTDo6TGliWE1MOjpYUGF0aENvbnRleHQtPm5ldygkc2VsZi0+e3htbF9hc19kb219KTsKCSR4cGF0aC0+cmVnaXN0ZXJOcygic2FtbHAiLCAidXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOnByb3RvY29sIik7CgkkeHBhdGgtPnJlZ2lzdGVyTnMoInNhbWwiLCAidXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFzc2VydGlvbiIpOwoJbXkgJHF1ZXJ5ID0gIi9zYW1scDpSZXNwb25zZS9zYW1sOkFzc2VydGlvbi9zYW1sOlN1YmplY3Qvc2FtbDpOYW1lSUQiOwoJbXkgQG5vZGVzID0gJHhwYXRoLT5maW5kbm9kZXMoJHF1ZXJ5KTsKCQoJcmV0dXJuICRub2Rlc1swXS0+dG9TdHJpbmcoKTsKfQoKCnN1YiBnZXRfYXR0cmlidXRlKCkgewoJbXkgJHNlbGYgPSBzaGlmdDsKCW15ICggJG5hbWUgKSA9IEBfOwoJCiAgICBteSAkeHBhdGggPSBYTUw6OkxpYlhNTDo6WFBhdGhDb250ZXh0LT5uZXcoJHNlbGYtPnt4bWxfYXNfZG9tfSk7CgkkeHBhdGgtPnJlZ2lzdGVyTnMoInNhbWxwIiwgInVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpwcm90b2NvbCIpOwoJJHhwYXRoLT5yZWdpc3Rlck5zKCJzYW1sIiwgInVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphc3NlcnRpb24iKTsKCW15ICRxdWVyeSA9ICcvc2FtbHA6UmVzcG9uc2Uvc2FtbDpBc3NlcnRpb24vc2FtbDpBdHRyaWJ1dGVTdGF0ZW1lbnQvc2FtbDpBdHRyaWJ1dGVbQE5hbWU9IicuICRuYW1lIC4nIl0vc2FtbDpBdHRyaWJ1dGVWYWx1ZSc7CglteSBAZW50cmllcyA9ICR4cGF0aC0+ZmluZG5vZGVzKCRxdWVyeSk7CiAgICAKICAgIAogICAgaWYoc2NhbGFyKEBlbnRyaWVzKT4gMCl7CiAgICAgICAgaWYoc2NhbGFyKEBlbnRyaWVzKSA+IDEpIHsKICAgICAgICAgICAgbXkgQHJldHVybiA9ICgpOwogICAgICAgICAgICBmb3IobXkgJGk9MDsgJGkgPCBzY2FsYXIoQGVudHJpZXMpOyAkaSsrKSB7CiAgICAgICAgICAgICAgICBwdXNoKEByZXR1cm4sICRlbnRyaWVzWyRpXS0+dGV4dENvbnRlbnQoKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIEByZXR1cm47CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuICRlbnRyaWVzWzBdLT50ZXh0Q29udGVudCgpOwogICAgICAgICAgICAjcmV0dXJuICJtYXBwb2xvbmlhIjsKICAgICAgICB9CiAgICB9ZWxzZXsKICAgICAgICByZXR1cm4gOwogICAgfQp9CgoxOw==</File>
    </Filelist>
</otrs_package>