<?xml version="1.0" encoding="utf-8" ?>
<otrs_package version="1.1">
    <Name>SAML2SP</Name>
    <Version>0.0.2</Version>
    <Vendor>Fondation Restena</Vendor>
    <URL>https://www.restena.lu/</URL>
    <License>GNU GENERAL PUBLIC LICENSE Version 3, 29 June 2007</License>
    <ChangeLog Date="2024-05-16" Version="0.0.2">Detect algorithm to validate signature</ChangeLog>
    <Description Lang="en">SAML2 Service Provider for agents authentication.</Description>
    <Framework>6.x.x</Framework>
    <BuildDate>2024-05-16 14:23:32</BuildDate>
    <BuildHost>booksworm</BuildHost>
    <Filelist>
        <File Location="Kernel/System/Auth/SAML2SP.pm" Permission="644" Encode="Base64">IyAtLQojIEtlcm5lbDo6U3lzdGVtOjpBdXRoOjpTQU1MMlNQLnBtIC0gYXV0aGVudGljYXRpb24gbW9kdWxlCiMgQ29weXJpZ2h0IChDKSAoMjAxNikgKE1heGltZSBBcHBvbG9uaWEpIChtYXhpbWUuYXBwb2xvbmlhQHJlc3RlbmEubHUpCiMgaHR0cHM6Ly9naXRodWIuY29tL3Jlc3RlbmEtbWEvb3Rycy1zYW1sMnNwCiMgLS0KIyBUaGlzIHNvZnR3YXJlIGNvbWVzIHdpdGggQUJTT0xVVEVMWSBOTyBXQVJSQU5UWS4gRm9yIGRldGFpbHMsIHNlZQojIHRoZSBlbmNsb3NlZCBmaWxlIENPUFlJTkcgZm9yIGxpY2Vuc2UgaW5mb3JtYXRpb24gKEFHUEwpLiBJZiB5b3UKIyBkaWQgbm90IHJlY2VpdmUgdGhpcyBmaWxlLCBzZWUgaHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzL2FncGwudHh0LgojIC0tCiMgTm90ZToKIwojICBJbiBvcmRlciB0byBkaXNwbGF5IGEgIkxvZ2luIHZpYSBTQU1MIiBidXR0b24geW91IGhhdmUgdG8gaW5jbHVkZSB0aGUgaHRtbCBjb2RlIGJlbG93IGludG8gdGhlIExvZ2luLnR0IHRlbXBsYXRlIGZpbGUgbmVhciB0aGUgbG9naW4gZm9ybQojCiMgIDwhLS0gQWRkIHRoZSBzc28gbG9naW4gYnV0dG9uIC0tPgojICA8ZGl2IGNsYXNzPSJDb250ZW50IiBzdHlsZT0idGV4dC1hbGlnbjogY2VudGVyOyBkaXNwbGF5OiBibG9jazsgaGVpZ2h0OiA0MHB4OyBwYWRkaW5nLXRvcDogMjBweDsgcGFkZGluZy1ib3R0b206IDA7IHZlcnRpY2FsLWFsaWduOiBib3R0b207IGxpbmUtaGVpZ2h0OiA0MHB4OyI+CiMgICAgPGEgaHJlZj0iLi9pbmRleC5wbD9BY3Rpb249TG9naW4mV2FudFNBTUxSZXF1ZXN0PXRydWUiIHN0eWxlPSJiYWNrZ3JvdW5kOiAjZTllOWU5OyBib3JkZXItcmFkaXVzOiA1cHg7IHBhZGRpbmc6IDEwcHg7Ym9yZGVyOiAxcHggc29saWQgI2NjYzsgZm9udC13ZWlnaHQ6IGJvbGQ7IiA+TG9naW4gdmlhIFNBTUwyIFNTTzwvYT4KIyAgPC9kaXY+CiMgIDwhLS0gZW5kIHNzbyBsb2dpbiBidXR0b24gLS0+CiMKIwojICBJbiB0aGUgRGVmYXVsdC5wbSB5b3UgY2FuIGFjdGl2ZSB0aGlzIGF1dGggbW9kdWxlIHdpdGggYSBmYWxsYmFjayBvbiB0aGUgZGVmYXVsdCBEQiBtb2R1bGUKIyAgCiMgICRTZWxmLT57QXV0aE1vZHVsZTF9ID0gJ0tlcm5lbDo6U3lzdGVtOjpBdXRoOjpEQic7CiMgICRTZWxmLT57QXV0aE1vZHVsZX0gPSAnS2VybmVsOjpTeXN0ZW06OkF1dGg6OlNBTUwyU1AnOwojICAkU2VsZi0+eydBdXRoTW9kdWxlOjpTQU1MMlNQOjpTU09JZHBVcmwnfSA9ICdodHRwczovL2lkcC5leGFtcGxlLmNvbS9zaW1wbGVzYW1sL3NhbWwyL2lkcC9TU09TZXJ2aWNlLnBocCc7CiMgICRTZWxmLT57J0F1dGhNb2R1bGU6OlNBTUwyU1A6OlNTT0Fzc2VydGlvbkNvbnN1bWVyVVJMJ30gPSAnL290cnMvaW5kZXgucGw/QWN0aW9uPUxvZ2luJzsKIyAgJFNlbGYtPnsnQXV0aE1vZHVsZTo6U0FNTDJTUDo6U1NPVXNlcklkQXR0cmlidXRlJ30gPSAnVXNlcklkJzsKIyAgJFNlbGYtPnsnQXV0aE1vZHVsZTo6U0FNTDJTUDo6U1NPeDUwOUNlcnQnfSA9ICItLS0tLUJFR0lOIENFUlRJRklDQVRFLS0tLS14eHh4eHh4LS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLSI7CiMKIyAtLQoKcGFja2FnZSBLZXJuZWw6OlN5c3RlbTo6QXV0aDo6U0FNTDJTUDsKCnVzZSBzdHJpY3Q7CnVzZSB3YXJuaW5nczsKCm91ciBAT2JqZWN0RGVwZW5kZW5jaWVzID0gKAogICAgJ0tlcm5lbDo6Q29uZmlnJywKICAgICdLZXJuZWw6OlN5c3RlbTo6V2ViOjpSZXF1ZXN0JywKICAgICdLZXJuZWw6OlN5c3RlbTo6TG9nJwopOwoKCnVzZSBDR0k7CiN1c2UgRmluZEJpbiBxdygkQmluKTsKI3VzZSBsaWIgIiRCaW4vLi4vIjsKdXNlIEtlcm5lbDo6U3lzdGVtOjpBdXRoOjpTQU1MMlNQOjpDb25maWc7CnVzZSBLZXJuZWw6OlN5c3RlbTo6QXV0aDo6U0FNTDJTUDo6QXV0aFJlcXVlc3Q7CnVzZSBLZXJuZWw6OlN5c3RlbTo6QXV0aDo6U0FNTDJTUDo6UmVzcG9uc2U7CgpzdWIgbmV3IHsKICAgIG15ICggJFR5cGUsICVQYXJhbSApID0gQF87CgogICAgIyBhbGxvY2F0ZSBuZXcgaGFzaCBmb3Igb2JqZWN0CiAgICBteSAkU2VsZiA9IHt9OwogICAgYmxlc3MoICRTZWxmLCAkVHlwZSApOwoKICAgICMgRGVidWcgMD1vZmYgMT1vbgogICAgJFNlbGYtPntEZWJ1Z30gPSAwOwoKICAgICMgZ2V0IGNvbmZpZyBvYmplY3QKICAgIG15ICRDb25maWdPYmplY3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OkNvbmZpZycpOwoKCiAgICAjIGdldCBjb25maWcKICAgICRTZWxmLT57U1NPSWRwVXJsfSA9ICRDb25maWdPYmplY3QtPkdldCggJ0F1dGhNb2R1bGU6OlNBTUwyU1A6OlNTT0lkcFVybCcgLiAkUGFyYW17Q291bnR9ICkgfHwgZGllICJOZWVkIEF1dGhNb2R1bGU6OlNBTUwyU1A6OlNTT0lkcFVybHtDb3VudH0gaW4gS2VybmVsL0NvbmZpZy5wbSI7CiAgICAkU2VsZi0+e1NTT0Fzc2VydGlvbkNvbnN1bWVyVVJMfSA9ICRDb25maWdPYmplY3QtPkdldCggJ0F1dGhNb2R1bGU6OlNBTUwyU1A6OlNTT0Fzc2VydGlvbkNvbnN1bWVyVVJMJyAuICRQYXJhbXtDb3VudH0gKSB8fCBkaWUgIk5lZWQgQXV0aE1vZHVsZTo6U0FNTDJTUDo6U1NPQXNzZXJ0aW9uQ29uc3VtZXJVUkx7Q291bnR9IGluIEtlcm5lbC9Db25maWcucG0iOwogICAgJFNlbGYtPntTU09Vc2VySWRBdHRyaWJ1dGV9ID0gJENvbmZpZ09iamVjdC0+R2V0KCAnQXV0aE1vZHVsZTo6U0FNTDJTUDo6U1NPVXNlcklkQXR0cmlidXRlJyAuICRQYXJhbXtDb3VudH0gKSB8fCBkaWUgIk5lZWQgQXV0aE1vZHVsZTo6U0FNTDJTUDo6U1NPVXNlcklkQXR0cmlidXRle0NvdW50fSBpbiBLZXJuZWwvQ29uZmlnLnBtIjsKICAgICRTZWxmLT57U1NPeDUwOUNlcnR9ID0gJENvbmZpZ09iamVjdC0+R2V0KCAnQXV0aE1vZHVsZTo6U0FNTDJTUDo6U1NPeDUwOUNlcnQnIC4gJFBhcmFte0NvdW50fSApIHx8IGRpZSAiTmVlZCBBdXRoTW9kdWxlOjpTQU1MMlNQOjpTU094NTA5Q2VydHtDb3VudH0gaW4gS2VybmVsL0NvbmZpZy5wbSI7CgoKICAgIHJldHVybiAkU2VsZjsKfQoKCnN1YiBHZXRPcHRpb24gewogICAgbXkgKCAkU2VsZiwgJVBhcmFtICkgPSBAXzsKCiAgICAjIGNoZWNrIG5lZWRlZCBzdHVmZgogICAgaWYgKCAhJFBhcmFte1doYXR9ICkgewogICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKAogICAgICAgICAgICBQcmlvcml0eSA9PiAnZXJyb3InLAogICAgICAgICAgICBNZXNzYWdlICA9PiAiTmVlZCBXaGF0ISIKICAgICAgICApOwogICAgICAgIHJldHVybjsKICAgIH0KCiAgICAjIG1vZHVsZSBvcHRpb25zCiAgICBteSAlT3B0aW9uID0gKAogICAgICAgIFByZUF1dGggPT4gMCwKICAgICk7CgogICAgIyByZXR1cm4gb3B0aW9uCiAgICByZXR1cm4gJE9wdGlvbnsgJFBhcmFte1doYXR9IH07Cn0KCnN1YiBBdXRoIHsKICAgIG15ICggJFNlbGYsICVQYXJhbSApID0gQF87CiAgICAKICAgIG15ICRQYXJhbU9iamVjdCAgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6V2ViOjpSZXF1ZXN0Jyk7CiAgICAKICAgIG15ICR3YW50U2FtbFJlcXVlc3QgPSAkUGFyYW1PYmplY3QtPkdldFBhcmFtKCBQYXJhbSA9PiAnV2FudFNBTUxSZXF1ZXN0JyApOwoJbXkgJHNhbWxSZXNwb25zZSA9ICRQYXJhbU9iamVjdC0+R2V0UGFyYW0oIFBhcmFtID0+ICdTQU1MUmVzcG9uc2UnICk7CiAgICAKICAgIAogICAgbXkgJGNvbmZpZyA9IEtlcm5lbDo6U3lzdGVtOjpBdXRoOjpTQU1MMlNQOjpDb25maWctPm5ldyhDR0ktPm5ldygpKTsKICAgICRjb25maWctPntpZHBfc3NvX3RhcmdldF91cmx9ID0gJFNlbGYtPntTU09JZHBVcmx9OwoJJGNvbmZpZy0+e2Fzc2VydGlvbl9jb25zdW1lcl9zZXJ2aWNlX3VybH0gPSAiJEVOVntSRVFVRVNUX1NDSEVNRX06Ly8kRU5We0hUVFBfSE9TVH0vIiAuICRTZWxmLT57U1NPQXNzZXJ0aW9uQ29uc3VtZXJVUkx9OwoJJGNvbmZpZy0+e1NTT3g1MDlDZXJ0fSA9ICRTZWxmLT57U1NPeDUwOUNlcnR9OwoJCgkKICAgIGlmKCAhIGRlZmluZWQgJHNhbWxSZXNwb25zZSB8fCAkc2FtbFJlc3BvbnNlIGVxICIiICl7CgoJCSMgVGhpcyBwYWdlIGNhbGwgaXMgbm90IHRyaWdnZXJlZCBieSBhbiBzYW1sIHJlc3BvbnNlLiBXZSB3aWxsIGNyZWF0ZSBhbiBzYW1sIHJlcXVlc3Qgb25seSBpZiBpdCB3YXMgZXhwbGljaXRlbHkgcmVxdWVzdGVkCgkJaWYoIGRlZmluZWQgJHdhbnRTYW1sUmVxdWVzdCl7CgkJCW15ICRyZXF1ZXN0ID0gS2VybmVsOjpTeXN0ZW06OkF1dGg6OlNBTUwyU1A6OkF1dGhSZXF1ZXN0LT5uZXcoJGNvbmZpZyk7CgkJCW15ICRpZHBfcmVkaXJlY3QgPSAkcmVxdWVzdC0+Y3JlYXRlKCkuIiZSZXR1cm5VUkw9Ii4kY29uZmlnLT57YXNzZXJ0aW9uX2NvbnN1bWVyX3NlcnZpY2VfdXJsfTsKCQkJcHJpbnQgQ0dJOjpyZWRpcmVjdCgkaWRwX3JlZGlyZWN0KTsKCQl9ZWxzZXsKCQkJcmV0dXJuOwoJCX0KCQkKCX1lbHNlewoJCW15ICRyZXNwb25zZSA9IEtlcm5lbDo6U3lzdGVtOjpBdXRoOjpTQU1MMlNQOjpSZXNwb25zZS0+bmV3KCRzYW1sUmVzcG9uc2UsICRjb25maWcpOwoJCQoJCWlmKCRyZXNwb25zZS0+aXNfdmFsaWQoKSl7CgkJCXJldHVybiAkcmVzcG9uc2UtPmdldF9hdHRyaWJ1dGUoJFNlbGYtPntTU09Vc2VySWRBdHRyaWJ1dGV9KTsKCQl9ZWxzZXsKCQkJJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coCgkgICAgICAgICAgICBQcmlvcml0eSA9PiAnZXJyb3InLAoJICAgICAgICAgICAgTWVzc2FnZSAgPT4gIlJlY2VpdmVkIGFuIFNBTUwgcmVzcG9uc2Ugd2l0aCBhIHdyb25nIHNpZ25hdHVyZSEiCiAgICAgICAgCSk7CiAgICAgICAgCgkJCXJldHVybjsKCQl9CgkJCgkJCgl9CiAgICAKICAgIAogICAgCglyZXR1cm47Cn0KCjE7</File>
        <File Location="Kernel/System/Auth/SAML2SP/AuthRequest.pm" Permission="644" Encode="Base64">IyAtLQojIEtlcm5lbDo6U3lzdGVtOjpBdXRoOjpTQU1MMlNQOjpBdXRoUmVxdWVzdC5wbSAtIGF1dGhlbnRpY2F0aW9uIG1vZHVsZQojIENvcHlyaWdodCAoQykgKDIwMTYpIChNYXhpbWUgQXBwb2xvbmlhKSAobWF4aW1lLmFwcG9sb25pYUByZXN0ZW5hLmx1KQojIGh0dHBzOi8vZ2l0aHViLmNvbS9yZXN0ZW5hLW1hL290cnMtc2FtbDJzcAojIC0tCiMgVGhpcyBzb2Z0d2FyZSBjb21lcyB3aXRoIEFCU09MVVRFTFkgTk8gV0FSUkFOVFkuIEZvciBkZXRhaWxzLCBzZWUKIyB0aGUgZW5jbG9zZWQgZmlsZSBDT1BZSU5HIGZvciBsaWNlbnNlIGluZm9ybWF0aW9uIChBR1BMKS4gSWYgeW91CiMgZGlkIG5vdCByZWNlaXZlIHRoaXMgZmlsZSwgc2VlIGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9hZ3BsLnR4dC4KIyAtLQoKcGFja2FnZSBLZXJuZWw6OlN5c3RlbTo6QXV0aDo6U0FNTDJTUDo6QXV0aFJlcXVlc3Q7Cgp1c2Ugc3RyaWN0Owp1c2Ugd2FybmluZ3M7Cgp1c2UgRGF0ZVRpbWU7CnVzZSBNSU1FOjpCYXNlNjQ7CnVzZSBDb21wcmVzczo6WmxpYjsKdXNlIFVSSTo6RXNjYXBlOwoKCnN1YiBuZXd7CglteSAkY2xhc3MgPSBzaGlmdDsKCW15ICggJHNldHRpbmdzICkgPSBAXzsgCgkKCW15ICRzZWxmID0gYmxlc3MgewoJCXNldHRpbmdzID0+ICRzZXR0aW5ncyAKCX0sICRjbGFzczsgCgkKCXJldHVybiAkc2VsZjsKfQoKc3ViIGNyZWF0ZXsKCW15ICRzZWxmID0gc2hpZnQ7CgkKCQogICAgCglteSAkaWQgPSAkc2VsZi0+Z2VuZXJhdGVVbmlxdWVJRCgyMCk7CglteSAkaXNzdWVfaW5zdGFudCA9ICRzZWxmLT5nZXRUaW1lU3RhbXAoKTsKCiAgICBteSAkcmVxdWVzdCA9ICI8c2FtbHA6QXV0aG5SZXF1ZXN0IHhtbG5zOnNhbWxwPVwidXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOnByb3RvY29sXCIgSUQ9XCIkaWRcIiBWZXJzaW9uPVwiMi4wXCIgSXNzdWVJbnN0YW50PVwiJGlzc3VlX2luc3RhbnRcIiBQcm90b2NvbEJpbmRpbmc9XCJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YmluZGluZ3M6SFRUUC1QT1NUXCIgQXNzZXJ0aW9uQ29uc3VtZXJTZXJ2aWNlVVJMPVwiIi4kc2VsZi0+e3NldHRpbmdzfS0+e2Fzc2VydGlvbl9jb25zdW1lcl9zZXJ2aWNlX3VybH0uIlwiPiIuCiAgICAgICAgICAgICI8c2FtbDpJc3N1ZXIgeG1sbnM6c2FtbD1cInVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphc3NlcnRpb25cIj4iLiRzZWxmLT57c2V0dGluZ3N9LT57aXNzdWVyfS4iPC9zYW1sOklzc3Vlcj5cbiIuCiAgICAgICAgICAgICI8c2FtbHA6TmFtZUlEUG9saWN5IHhtbG5zOnNhbWxwPVwidXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOnByb3RvY29sXCIgRm9ybWF0PVwiJHNlbGYtPntzZXR0aW5nc30tPntuYW1lX2lkZW50aWZpZXJfZm9ybWF0fVwiIEFsbG93Q3JlYXRlPVwidHJ1ZVwiPjwvc2FtbHA6TmFtZUlEUG9saWN5PlxuIi4KICAgICAgICAgICAgIjwvc2FtbHA6QXV0aG5SZXF1ZXN0PiI7CgkKCQoJbXkgJGRlZmxhdGVkX3JlcXVlc3QgID0gY29tcHJlc3MoJHJlcXVlc3QpOwoJJGRlZmxhdGVkX3JlcXVlc3QgPSBzdWJzdHIoJGRlZmxhdGVkX3JlcXVlc3QsIDIsIGxlbmd0aCgkZGVmbGF0ZWRfcmVxdWVzdCktNCk7ICMgcGhwIGluZmxhdGUgZG9lcyBub3QgbGlrZSBmaXJzdCAyIGJ5dGVzIGFuZCBsYXN0IDR0aCA/IT8KCQoJCglteSAkYmFzZTY0X3JlcXVlc3QgPSBlbmNvZGVfYmFzZTY0KCRkZWZsYXRlZF9yZXF1ZXN0KTsKCQoJbXkgJGVuY29kZWRfcmVxdWVzdCA9IHVyaV9lc2NhcGUoJGJhc2U2NF9yZXF1ZXN0KTsKCQogICAgcmV0dXJuICRzZWxmLT57c2V0dGluZ3N9LT57aWRwX3Nzb190YXJnZXRfdXJsfS4iP1NBTUxSZXF1ZXN0PSIuJGVuY29kZWRfcmVxdWVzdDsKfQoKCnN1YiBnZW5lcmF0ZVVuaXF1ZUlEewoJbXkgJHNlbGYgPSBzaGlmdDsKCW15ICggJGxlbmd0aCApID0gQF87CgkKCW15ICRjaGFycyA9ICJhYmNkZWYwMTIzNDU2Nzg5IjsKICAgIG15ICRjaGFyc19sZW4gPSBsZW5ndGgoJGNoYXJzKTsKICAgIG15ICR1bmlxdWVJRCA9ICIiOwogICAgZm9yIChteSAkaSA9IDA7ICRpIDwgJGxlbmd0aDsgJGkrKyl7CiAgICAJJHVuaXF1ZUlEIC49IHN1YnN0cigkY2hhcnMscmFuZCgkY2hhcnNfbGVuKSwxKTsKICAgIH0KICAgIHJldHVybiAiXyIuJHVuaXF1ZUlEOwp9CgoKc3ViIGdldFRpbWVTdGFtcHsKCW15ICRzZWxmID0gc2hpZnQ7CgkKICAgIG15ICRkdCA9IERhdGVUaW1lLT5ub3coKTsKICAgIHJldHVybiAkZHQtPnN0cmZ0aW1lKCIlWS0lbS0lZFQlSDolTTolU1oiKTsKfQoKMTs=</File>
        <File Location="Kernel/System/Auth/SAML2SP/Config.pm" Permission="644" Encode="Base64">IyAtLQojIEtlcm5lbDo6U3lzdGVtOjpBdXRoOjpTQU1MMlNQOjpDb25maWcucG0gLSBhdXRoZW50aWNhdGlvbiBtb2R1bGUKIyBDb3B5cmlnaHQgKEMpICgyMDE2KSAoTWF4aW1lIEFwcG9sb25pYSkgKG1heGltZS5hcHBvbG9uaWFAcmVzdGVuYS5sdSkKIyBodHRwczovL2dpdGh1Yi5jb20vcmVzdGVuYS1tYS9vdHJzLXNhbWwyc3AKIyAtLQojIFRoaXMgc29mdHdhcmUgY29tZXMgd2l0aCBBQlNPTFVURUxZIE5PIFdBUlJBTlRZLiBGb3IgZGV0YWlscywgc2VlCiMgdGhlIGVuY2xvc2VkIGZpbGUgQ09QWUlORyBmb3IgbGljZW5zZSBpbmZvcm1hdGlvbiAoQUdQTCkuIElmIHlvdQojIGRpZCBub3QgcmVjZWl2ZSB0aGlzIGZpbGUsIHNlZSBodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvYWdwbC50eHQuCiMgLS0KCnBhY2thZ2UgS2VybmVsOjpTeXN0ZW06OkF1dGg6OlNBTUwyU1A6OkNvbmZpZzsKCnVzZSBzdHJpY3Q7CnVzZSB3YXJuaW5nczsKCiMgVGhpcyBjbGFzcyBpcyBhIHN0cnVjdHVyZSB3aGljaCBob2xkcyB0aGUgc2V0dGluZ3MgZGVmaW5lZCBpbiB0aGUgb3RycyBjb25maWcgZmlsZQojIERvIG5vdCBmaWxsIHlvdXIgc2V0dGluZ3MgaGVyZSAhCgpzdWIgbmV3ewoJbXkgJGNsYXNzID0gc2hpZnQ7CglteSAoICRjZ2kgKSA9IEBfOyAKCQoJbXkgJHNlbGYgPSBibGVzcyB7CgkJaWRwX3Nzb190YXJnZXRfdXJsID0+ICIiLAoJCXg1MDljZXJ0aWZpY2F0ZSA9PiAiIiwKCQlhc3NlcnRpb25fY29uc3VtZXJfc2VydmljZV91cmwgPT4gJGNnaS0+dXJsKCksCgkJaXNzdWVyID0+ICIkRU5We1JFUVVFU1RfU0NIRU1FfTovLyRFTlZ7SFRUUF9IT1NUfS8iLAoJCW5hbWVfaWRlbnRpZmllcl9mb3JtYXQgPT4gInVybjpvYXNpczpuYW1lczp0YzpTQU1MOjEuMTpuYW1laWQtZm9ybWF0OmVtYWlsQWRkcmVzcyIKCX0sICRjbGFzczsgCgkKCXJldHVybiAkc2VsZjsKfQoKMTs=</File>
        <File Location="Kernel/System/Auth/SAML2SP/Response.pm" Permission="644" Encode="Base64">IyAtLQojIEtlcm5lbDo6U3lzdGVtOjpBdXRoOjpTQU1MMlNQOjpSZXNwb25zZS5wbSAtIGF1dGhlbnRpY2F0aW9uIG1vZHVsZQojIENvcHlyaWdodCAoQykgKDIwMTYpIChNYXhpbWUgQXBwb2xvbmlhKSAobWF4aW1lLmFwcG9sb25pYUByZXN0ZW5hLmx1KQojIGh0dHBzOi8vZ2l0aHViLmNvbS9yZXN0ZW5hLW1hL290cnMtc2FtbDJzcAojIC0tCiMgVGhpcyBzb2Z0d2FyZSBjb21lcyB3aXRoIEFCU09MVVRFTFkgTk8gV0FSUkFOVFkuIEZvciBkZXRhaWxzLCBzZWUKIyB0aGUgZW5jbG9zZWQgZmlsZSBDT1BZSU5HIGZvciBsaWNlbnNlIGluZm9ybWF0aW9uIChBR1BMKS4gSWYgeW91CiMgZGlkIG5vdCByZWNlaXZlIHRoaXMgZmlsZSwgc2VlIGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9hZ3BsLnR4dC4KIyAtLQoKcGFja2FnZSBLZXJuZWw6OlN5c3RlbTo6QXV0aDo6U0FNTDJTUDo6UmVzcG9uc2U7Cgp1c2Ugc3RyaWN0Owp1c2Ugd2FybmluZ3M7Cgp1c2UgRGF0YTo6RHVtcGVyOwp1c2UgRGF0ZVRpbWU7CnVzZSBEYXRlVGltZTo6Rm9ybWF0OjpEYXRlUGFyc2U7CnVzZSBNSU1FOjpCYXNlNjQ7CnVzZSBYTUw6OkxpYlhNTDsKdXNlIERpZ2VzdDo6U0hBIHF3KHNoYTFfYmFzZTY0IHNoYTI1Nl9iYXNlNjQgc2hhNTEyX2Jhc2U2NCk7CnVzZSBDcnlwdDo6T3BlblNTTDo6UlNBOwp1c2UgQ3J5cHQ6Ok9wZW5TU0w6Olg1MDk7CnVzZSBTd2l0Y2g7CgoKc3ViIG5ld3sKCW15ICRjbGFzcyA9IHNoaWZ0OwoJbXkgKCAkcmF3X3Jlc3BvbnNlLCAkc2V0dGluZ3MgKSA9IEBfOwoJCglteSAkc2VsZiA9IGJsZXNzIHsKCQlyYXdfcmVzcG9uc2UgPT4gJHJhd19yZXNwb25zZSwKCQlzZXR0aW5ncyA9PiAkc2V0dGluZ3MsCgkJeG1sX2FzX2RvbSA9PiAiIiwKCQlzaWduYXR1cmVfbm9kZSA9PiAiIiwKCQlzaWduZWRJbmZvID0+ICIiLAoJCXZhbGlkYXRlZF9ub2RlcyA9PiB1bmRlZiwKCQlzaWduZWRfaW5mbyA9PiAiIiwKCQlrZXlfc2lnbl9hbGdvID0+ICIiCgl9LCAkY2xhc3M7CgkKCSRzZWxmLT5kZWNvZGUoKTsKCQoJcmV0dXJuICRzZWxmOwp9CgoKc3ViIGRlY29kZXsKCW15ICRzZWxmID0gc2hpZnQ7CgkKCSRzZWxmLT57eG1sX2FzX3N0cmluZ30gPSBkZWNvZGVfYmFzZTY0KCRzZWxmLT57cmF3X3Jlc3BvbnNlfSk7CgkKCW15ICRwYXJzZXIgPSBYTUw6OkxpYlhNTC0+bmV3KCk7Cgkkc2VsZi0+e3htbF9hc19kb219ID0gJHBhcnNlci0+cGFyc2Vfc3RyaW5nKCRzZWxmLT57eG1sX2FzX3N0cmluZ30pOwp9CgoKc3ViIGlzX3ZhbGlkewoJbXkgJHNlbGYgPSBzaGlmdDsKCQoJaWYoISRzZWxmLT52YWxpZGF0ZU51bUFzc2VydGlvbnMoKSl7CgkJJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coUHJpb3JpdHkgPT4gJ2Vycm9yJywgTWVzc2FnZSAgPT4gIlNBTUw6IG5vIG9yIG1vcmUgdGhhbiBvbmUgc2FtbCBhc3NlcnRpb24gaW4gdGhlIHJlc3BvbnNlLCBuZWVkIG9ubHkgb25lIik7CgkJcmV0dXJuOwoJfQoJCglpZighJHNlbGYtPnZhbGlkYXRlVGltZXN0YW1wcygpKXsKCQkkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZyhQcmlvcml0eSA9PiAnZXJyb3InLCBNZXNzYWdlICA9PiAiU0FNTDogdGltZXN0YW1wcyBkbyBub3QgbWF0Y2giKTsKCQlyZXR1cm47Cgl9CgkKCWlmKCEkc2VsZi0+dmFsaWRhdGVUaW1lc3RhbXBzKCkpewoJCSRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKFByaW9yaXR5ID0+ICdlcnJvcicsIE1lc3NhZ2UgID0+ICJTQU1MOiB0aW1lc3RhbXBzIGRvIG5vdCBtYXRjaCIpOwoJCXJldHVybjsKCX0KCQoJCglteSAkc2lnbmF0dXJlID0gJHNlbGYtPmdldF9zaWduYXR1cmUoKTsKCWlmKCEkc2lnbmF0dXJlKXsKCQkkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZyhQcmlvcml0eSA9PiAnZXJyb3InLCBNZXNzYWdlICA9PiAiU0FNTDogbm8gZGlnaXRhbCBzaWduYXR1cmUgZm91bmQiKTsKCQlyZXR1cm47Cgl9CgkjJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coUHJpb3JpdHkgPT4gJ2Vycm9yJywgTWVzc2FnZSAgPT4gIkRFQlVHOiAiLiRzaWduYXR1cmUpOwoJCgkkc2VsZi0+e3NpZ25lZF9pbmZvfSA9ICRzZWxmLT5jYW5vbmljYWxpemVTaWduZWRJbmZvKCk7CgkKCWlmKCEkc2VsZi0+dmFsaWRhdGVfcmVmZXJlbmNlKCkpewoJCSRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKFByaW9yaXR5ID0+ICdlcnJvcicsIE1lc3NhZ2UgID0+ICJTQU1MOiBkaWdlc3QgaXMgbm90IHZhbGlkIG9yIHdhcyBub3QgZm91bmQiKTsKCQlyZXR1cm47Cgl9CgkKCW15ICRvYmpLZXkgPSAkc2VsZi0+bG9jYXRlS2V5KCk7CglpZighICRvYmpLZXkgKSB7CgkJCSRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKFByaW9yaXR5ID0+ICdlcnJvcicsIE1lc3NhZ2UgID0+ICJTQU1MOiBXZSBoYXZlIG5vIGlkZWEgYWJvdXQgdGhlIGtleSIpOwoJCQlyZXR1cm47Cgl9CgkKCWlmKCEkc2VsZi0+dmVyaWZ5X3NpZ25hdHVyZSgpKXsKCQkkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZyhQcmlvcml0eSA9PiAnZXJyb3InLCBNZXNzYWdlICA9PiAiU0FNTDogU2lnbmF0dXJlIHZlcmlmaWNhdGlvbiBmYWlsZWQgISIpOwoJCXJldHVybjsJCQoJfQoJCglyZXR1cm4gMTsKfQoKCnN1YiBnZXRfc2lnbmF0dXJlewoJbXkgJHNlbGYgPSBzaGlmdDsKCQoJbXkgJHhwYXRoID0gWE1MOjpMaWJYTUw6OlhQYXRoQ29udGV4dC0+bmV3KCRzZWxmLT57eG1sX2FzX2RvbX0pOwoJJHhwYXRoLT5yZWdpc3Rlck5zKCJzZWNkc2lnIiwgImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyMiKTsKCW15ICRxdWVyeSA9ICIuLy9zZWNkc2lnOlNpZ25hdHVyZSI7CglteSBAbm9kZXMgPSAkeHBhdGgtPmZpbmRub2RlcygkcXVlcnkpOwoJJHNlbGYtPntzaWduYXR1cmVfbm9kZX0gPSAkbm9kZXNbMF07IAoJcmV0dXJuICRub2Rlc1swXTsKfQoKCnN1YiBjYW5vbmljYWxpemVTaWduZWRJbmZvKCkgewoJbXkgJHNlbGYgPSBzaGlmdDsKCQoJbXkgJGNhbm9uaWNhbG1ldGhvZCA9IHVuZGVmOwoJCglteSAkeHBhdGggPSBYTUw6OkxpYlhNTDo6WFBhdGhDb250ZXh0LT5uZXcoJHNlbGYtPntzaWduYXR1cmVfbm9kZX0pOwoJJHhwYXRoLT5yZWdpc3Rlck5zKCJzZWNkc2lnIiwgImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyMiKTsKCW15ICRxdWVyeSA9ICIuL3NlY2RzaWc6U2lnbmVkSW5mbyI7CglteSBAbm9kZXMgPSAkeHBhdGgtPmZpbmRub2RlcygkcXVlcnkpOwoJbXkgJHNpZ25JbmZvTm9kZSA9ICRub2Rlc1swXTsKCWlmICgkc2lnbkluZm9Ob2RlKSB7CgkJbXkgJHhwYXRoMiA9IFhNTDo6TGliWE1MOjpYUGF0aENvbnRleHQtPm5ldygkc2lnbkluZm9Ob2RlKTsKCQkkeHBhdGgyLT5yZWdpc3Rlck5zKCJzZWNkc2lnIiwgImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyMiKTsKCQlteSAkcXVlcnkyID0gIi4vc2VjZHNpZzpDYW5vbmljYWxpemF0aW9uTWV0aG9kIjsKCQlteSBAbm9kZXMyID0gJHhwYXRoMi0+ZmluZG5vZGVzKCRxdWVyeTIpOwoJCW15ICRjYW5vbk5vZGUgPSAkbm9kZXMyWzBdOyAgCgkJbXkgQGF0dHIgPSAkY2Fub25Ob2RlLT5hdHRyaWJ1dGVzKCk7CgkJbXkgJGNhbm9uaWNhbG1ldGhvZDsKCQlmb3IobXkgJGo9MDsgJGogPCBzY2FsYXIoQGF0dHIpIDsgJGorKyl7CgkJCWlmKCRhdHRyWyRqXS0+bm9kZU5hbWUgZXEgIkFsZ29yaXRobSIpewoJCQkJJGNhbm9uaWNhbG1ldGhvZCA9ICRhdHRyWyRqXS0+dmFsdWU7CQoJCQl9CgkJfQoJCSRzZWxmLT57c2lnbmVkSW5mb30gPSAkc2VsZi0+Y2Fub25pY2FsaXplRGF0YSgkc2lnbkluZm9Ob2RlLCAkY2Fub25pY2FsbWV0aG9kKTsKCQkjJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coUHJpb3JpdHkgPT4gJ2Vycm9yJywgTWVzc2FnZSAgPT4gIkRFQlVHOiAiLkR1bXBlcigkc2VsZi0+e3NpZ25lZEluZm99KSk7CgkJcmV0dXJuICRzZWxmLT57c2lnbmVkSW5mb307Cgl9CglyZXR1cm47Cn0KCgpzdWIgY2Fub25pY2FsaXplRGF0YXsKCW15ICRzZWxmID0gc2hpZnQ7CglteSAoICRub2RlLCAkY2Fub25pY2FsbWV0aG9kICkgPSBAXzsgCgkKCW15ICRleGNsdXNpdmUgPSAwOwoJbXkgJHdpdGhDb21tZW50cyA9IDA7CglpZiAoJGNhbm9uaWNhbG1ldGhvZCBlcSAiaHR0cDovL3d3dy53My5vcmcvVFIvMjAwMS9SRUMteG1sLWMxNG4tMjAwMTAzMTUiKSB7ICAgIAoJCSRleGNsdXNpdmUgPSAwOwoJCSR3aXRoQ29tbWVudHMgPSAwOwoJfQoJCglpZiAoJGNhbm9uaWNhbG1ldGhvZCBlcSAiaHR0cDovL3d3dy53My5vcmcvVFIvMjAwMS9SRUMteG1sLWMxNG4tMjAwMTAzMTUjV2l0aENvbW1lbnRzIikgewoJCSR3aXRoQ29tbWVudHMgPSAxOwoJfQoJCglpZiAoJGNhbm9uaWNhbG1ldGhvZCBlcSAiaHR0cDovL3d3dy53My5vcmcvMjAwMS8xMC94bWwtZXhjLWMxNG4jIikgewoJCSRleGNsdXNpdmUgPSAxOwoJfQoJCglpZiAoJGNhbm9uaWNhbG1ldGhvZCBlcSAiaHR0cDovL3d3dy53My5vcmcvMjAwMS8xMC94bWwtZXhjLWMxNG4jV2l0aENvbW1lbnRzIikgewoJCSRleGNsdXNpdmUgPSAxOwoJCSR3aXRoQ29tbWVudHMgPSAxOwoJfQoJCglpZigkZXhjbHVzaXZlKXsKCQlyZXR1cm4gJG5vZGUtPnRvU3RyaW5nRUMxNE4oJHdpdGhDb21tZW50cyk7Cgl9ZWxzZXsKCQlyZXR1cm4gJG5vZGUtPnRvU3RyaW5nQzE0Tigkd2l0aENvbW1lbnRzKQoJfQoJCglyZXR1cm47Cn0KCgpzdWIgdmFsaWRhdGVfcmVmZXJlbmNlewoJbXkgJHNlbGYgPSBzaGlmdDsKCglpZiAoISRzZWxmLT57eG1sX2FzX2RvbX0tPmlzU2FtZU5vZGUoJHNlbGYtPntzaWduYXR1cmVfbm9kZX0pKSB7CgkJJHNlbGYtPntzaWduYXR1cmVfbm9kZX0tPnBhcmVudE5vZGUtPnJlbW92ZUNoaWxkKCRzZWxmLT57c2lnbmF0dXJlX25vZGV9KTsKCX0KCglteSAkeHBhdGggPSBYTUw6OkxpYlhNTDo6WFBhdGhDb250ZXh0LT5uZXcoJHNlbGYtPntzaWduYXR1cmVfbm9kZX0pOwoJJHhwYXRoLT5yZWdpc3Rlck5zKCJzZWNkc2lnIiwgImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyMiKTsKCW15ICRxdWVyeSA9ICIuL3NlY2RzaWc6U2lnbmVkSW5mby9zZWNkc2lnOlJlZmVyZW5jZSI7CglteSBAbm9kZXMgPSAkeHBhdGgtPmZpbmRub2RlcygkcXVlcnkpOwoJaWYoc2NhbGFyKEBub2Rlcyk9PTApewoJCXJldHVybjsKCX0KCQoJJHNlbGYtPnt2YWxpZGF0ZWRfbm9kZXN9ID0gKCk7CgoJZm9yKG15ICRpPTA7ICRpIDwgc2NhbGFyKEBub2Rlcyk7ICRpKyspIHsKCQlpZighJHNlbGYtPnByb2Nlc3NSZWZOb2RlKCRub2Rlc1skaV0pKXsKCQkJJHNlbGYtPnt2YWxpZGF0ZWRfbm9kZXN9ID0gKCk7CgkJCXJldHVybjsKCQl9Cgl9CgkKCXJldHVybiAxOwp9CgoKc3ViIHByb2Nlc3NSZWZOb2RlewoJbXkgJHNlbGYgPSBzaGlmdDsKCW15ICggJHJlZl9ub2RlICkgPSBAXzsKCQoJIyRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKFByaW9yaXR5ID0+ICdlcnJvcicsIE1lc3NhZ2UgID0+ICJTQU1MIERFQlVHOiAiLiAkcmVmX25vZGUpOwoJbXkgQGF0dHIgPSAkcmVmX25vZGUtPmF0dHJpYnV0ZXMoKTsKCW15ICRub2RlX2lkID0gIiI7Cglmb3IobXkgJGo9MDsgJGogPCBzY2FsYXIoQGF0dHIpIDsgJGorKyl7CgkJaWYoJGF0dHJbJGpdLT5ub2RlTmFtZSBlcSAiVVJJIil7CgkJCSRub2RlX2lkID0gJGF0dHJbJGpdLT52YWx1ZTsKCQkJaWYoIShzdWJzdHIoJG5vZGVfaWQsIDAsIDEpIGVxICIjIikpewoJCQkJIyBleHRlcm5hbCB1cmwgbm90IHN1cHBvcnRlZAoJCQkJcmV0dXJuOwoJCQl9CgkJCSRub2RlX2lkID0gc3Vic3RyKCRub2RlX2lkLCAxLCBsZW5ndGgoJG5vZGVfaWQpKTsKCQkJIyRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKFByaW9yaXR5ID0+ICdlcnJvcicsIE1lc3NhZ2UgID0+ICJTQU1MIERFQlVHOiAiLiAkbm9kZV9pZCk7CgkJfQoJfQoJCglteSAkeHBhdGggPSBYTUw6OkxpYlhNTDo6WFBhdGhDb250ZXh0LT5uZXcoJHNlbGYtPnt4bWxfYXNfZG9tfSk7CgkkeHBhdGgtPnJlZ2lzdGVyTnMoInNhbWxwIiwgInVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpwcm90b2NvbCIpOwoJJHhwYXRoLT5yZWdpc3Rlck5zKCJzYW1sIiwgInVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphc3NlcnRpb24iKTsKCW15ICRxdWVyeSA9ICcvLypbQElEPSInLiAkbm9kZV9pZCAuJyJdJzsKCW15IEBub2RlcyA9ICR4cGF0aC0+ZmluZG5vZGVzKCRxdWVyeSk7CgkjJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coUHJpb3JpdHkgPT4gJ2Vycm9yJywgTWVzc2FnZSA9PiAiU0FNTCBERUJVRzogIi4gRHVtcGVyKCRub2Rlc1swXSkpOwoJCglteSAkZGF0YU9iamVjdCA9ICRub2Rlc1swXTsKCQoJaWYoISRzZWxmLT52YWxpZGF0ZURpZ2VzdCgkcmVmX25vZGUsICRkYXRhT2JqZWN0KSl7CgkJcmV0dXJuOwoJfQoJCgkkc2VsZi0+e3ZhbGlkYXRlZF9ub2Rlc317JG5vZGVfaWR9ID0gJGRhdGFPYmplY3Q7IAoJCglyZXR1cm4gMTsKfQoKCnN1YiB2YWxpZGF0ZURpZ2VzdCgpewoJbXkgJHNlbGYgPSBzaGlmdDsKCW15ICggJHJlZl9ub2RlLCAkZGF0YV9vYmplY3QgKSA9IEBfOwoJCglteSAkeHBhdGggPSBYTUw6OkxpYlhNTDo6WFBhdGhDb250ZXh0LT5uZXcoJHJlZl9ub2RlKTsKCSR4cGF0aC0+cmVnaXN0ZXJOcygic2VjZHNpZyIsICJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjIik7CglteSAkcXVlcnkgPSAnLi9zZWNkc2lnOkRpZ2VzdE1ldGhvZC9AQWxnb3JpdGhtJzsKCW15IEBub2RlcyA9ICR4cGF0aC0+ZmluZG5vZGVzKCRxdWVyeSk7CglteSAkZGlnZXN0QWxnb3JpdGhtID0gJG5vZGVzWzBdLT50ZXh0Q29udGVudDsKCQoJbXkgJGRhdGEgPSAkc2VsZi0+cHJvY2Vzc1RyYW5zZm9ybXMoJHJlZl9ub2RlLCAkZGF0YV9vYmplY3QpOwoJbXkgJGNhbGN1bGF0ZWREaWdWYWx1ZSA9ICRzZWxmLT5jYWxjdWxhdGVEaWdlc3QoJGRpZ2VzdEFsZ29yaXRobSwgJGRhdGEpOwoJCQoJCSMgcmVtb3ZlID0gcGFkZG5nIGNoYXJhY3RlcnMKCQkkY2FsY3VsYXRlZERpZ1ZhbHVlID1+IHMvXG4vL2c7CgkJCgkJbXkgJHF1ZXJ5MiA9ICIuL3NlY2RzaWc6RGlnZXN0VmFsdWUiOwoJCW15IEBub2RlczIgPSAkeHBhdGgtPmZpbmRub2RlcygkcXVlcnkyLCAkcmVmX25vZGUpOwoJCW15ICRkaWdlc3RWYWx1ZSA9ICRub2RlczJbMF0tPnRleHRDb250ZW50OwoJCQoJCSMgcmVtb3ZlID0gcGFkZG5nIGNoYXJhY3RlcnMKCQkkZGlnZXN0VmFsdWUgPX4gcy9cPS8vZzsKCQkKCSMkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZyhQcmlvcml0eSA9PiAnZXJyb3InLCBNZXNzYWdlID0+ICItLS0iLiAkZGF0YSAuICItLS0iKTsKCQoJIyRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKFByaW9yaXR5ID0+ICdlcnJvcicsIE1lc3NhZ2UgPT4gIlNBTUwgREVCVUc6IHZhbCBoYXNoIGlzICIuICRjYWxjdWxhdGVkRGlnVmFsdWUpOwoJIyRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKFByaW9yaXR5ID0+ICdlcnJvcicsIE1lc3NhZ2UgPT4gIlNBTUwgREVCVUc6IHhtbCBoYXNoIGlzICIuICRkaWdlc3RWYWx1ZSk7CgkJCgkKCWlmKCRjYWxjdWxhdGVkRGlnVmFsdWUgIGVxICRkaWdlc3RWYWx1ZSl7CgkJIyRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKFByaW9yaXR5ID0+ICdlcnJvcicsIE1lc3NhZ2UgPT4gIlNBTUwgREVCVUc6IGRpZ2VzdCBhcmUgbWF0Y2hpbmciKTsKCQlyZXR1cm4gMTsKCX0JCgkKCSMkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZyhQcmlvcml0eSA9PiAnZXJyb3InLCBNZXNzYWdlID0+ICJTQU1MIERFQlVHOiBkaWdlc3QgYXJlIG5vdCBtYXRjaGluZyIpOwoJcmV0dXJuOwp9CgpzdWIgcHJvY2Vzc1RyYW5zZm9ybXMoKXsKCW15ICRzZWxmID0gc2hpZnQ7CglteSAoICRyZWZfbm9kZSwgJGRhdGFfb2JqZWN0ICkgPSBAXzsKCQoJcmV0dXJuICRzZWxmLT5jYW5vbmljYWxpemVEYXRhKCRkYXRhX29iamVjdCwgImh0dHA6Ly93d3cudzMub3JnLzIwMDEvMTAveG1sLWV4Yy1jMTRuIyIpOwp9CgpzdWIgY2FsY3VsYXRlRGlnZXN0KCl7CglteSAkc2VsZiA9IHNoaWZ0OwoJbXkgKCAkZGlnZXN0QWxnb3JpdGhtLCAkZGF0YSApID0gQF87CgkKCWlmKCRkaWdlc3RBbGdvcml0aG0gZXEgImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNzaGExIil7CgkJcmV0dXJuIHNoYTFfYmFzZTY0KCRkYXRhKTsKCX0KCQoJaWYoJGRpZ2VzdEFsZ29yaXRobSBlcSAiaHR0cDovL3d3dy53My5vcmcvMjAwMS8wNC94bWxlbmMjc2hhMjU2Iil7CgkJcmV0dXJuIHNoYTI1Nl9iYXNlNjQoJGRhdGEpOwoJfQoJCglpZigkZGlnZXN0QWxnb3JpdGhtIGVxICJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGVuYyNzaGE1MTIiKXsKCQlyZXR1cm4gc2hhNTEyX2Jhc2U2NCgkZGF0YSk7Cgl9CgkKCWlmKCRkaWdlc3RBbGdvcml0aG0gZXEgImh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZW5jI3JpcGVtZDE2MCIpewoJCSRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKFByaW9yaXR5ID0+ICdlcnJvcicsIE1lc3NhZ2UgPT4gIlNBTUwgZXJyb3I6IHJpcGVtZDE2MCBkaWdlc3Qgbm90IHN1cHBvcnRlZCIpOwoJCXJldHVybjsKCX0KCQoJcmV0dXJuOwp9CgoKc3ViIGxvY2F0ZUtleSgpewoJbXkgJHNlbGYgPSBzaGlmdDsKCQoJCglteSAkeHBhdGggPSBYTUw6OkxpYlhNTDo6WFBhdGhDb250ZXh0LT5uZXcoJHNlbGYtPntzaWduYXR1cmVfbm9kZX0pOwoJJHhwYXRoLT5yZWdpc3Rlck5zKCJzZWNkc2lnIiwgImh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyMiKTsKCW15ICRxdWVyeSA9ICcuL3NlY2RzaWc6U2lnbmVkSW5mby9zZWNkc2lnOlNpZ25hdHVyZU1ldGhvZC9AQWxnb3JpdGhtJzsKCW15IEBub2RlcyA9ICR4cGF0aC0+ZmluZG5vZGVzKCRxdWVyeSk7CgkKCQoJbXkgJGFsZ29yaXRobSA9ICRub2Rlc1swXS0+dGV4dENvbnRlbnQ7CglpZiAoJGFsZ29yaXRobSkgewoJCSMkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZyhQcmlvcml0eSA9PiAnZXJyb3InLCBNZXNzYWdlID0+ICJTQU1MIERFQlVHOiAiLiRhbGdvcml0aG0pOwoJCSRzZWxmLT57a2V5X3NpZ25fYWxnb30gPSAkYWxnb3JpdGhtOwoJCSMgJG9iaktleSA9IG5ldyBYTUxTZWN1cml0eUtleSgkYWxnb3JpdGhtLCBhcnJheSgndHlwZSc9PidwdWJsaWMnKSk7CgkJI3JldHVybiAkb2JqS2V5OwoJfQp9CgoKc3ViIHZlcmlmeV9zaWduYXR1cmUoKXsKCW15ICRzZWxmID0gc2hpZnQ7CgkKCW15ICR4cGF0aCA9IFhNTDo6TGliWE1MOjpYUGF0aENvbnRleHQtPm5ldygkc2VsZi0+e3NpZ25hdHVyZV9ub2RlfSk7CgkkeHBhdGgtPnJlZ2lzdGVyTnMoInNlY2RzaWciLCAiaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnIyIpOwoJbXkgJHF1ZXJ5ID0gJy4vc2VjZHNpZzpTaWduYXR1cmVWYWx1ZSc7CglteSBAbm9kZXMgPSAkeHBhdGgtPmZpbmRub2RlcygkcXVlcnkpOwoJbXkgJHNpZ1ZhbHVlID0gZGVjb2RlX2Jhc2U2NCgkbm9kZXNbMF0tPnRleHRDb250ZW50KTsKCQoJIyRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKFByaW9yaXR5ID0+ICdlcnJvcicsIE1lc3NhZ2UgPT4gIlNBTUwgREVCVUc6ICIuICRzZWxmLT57c2V0dGluZ3N9e1NTT3g1MDlDZXJ0fSk7CgkKCW15ICR4NTA5ID0gQ3J5cHQ6Ok9wZW5TU0w6Olg1MDktPm5ld19mcm9tX3N0cmluZygkc2VsZi0+e3NldHRpbmdzfXtTU094NTA5Q2VydH0sIENyeXB0OjpPcGVuU1NMOjpYNTA5OjpGT1JNQVRfUEVNKTsKCW15ICRwdWJrZXkgPSBDcnlwdDo6T3BlblNTTDo6UlNBLT5uZXdfcHVibGljX2tleSgkeDUwOS0+cHVia2V5KCkpOwoJc3dpdGNoKCRzZWxmLT57a2V5X3NpZ25fYWxnb30pIHsKCQljYXNlIC9yc2Etc2hhMjU2JC8geyAkcHVia2V5LT51c2Vfc2hhMjU2X2hhc2goKTsgfQoJCWNhc2UgL3JzYS1zaGEzODQkLyB7ICRwdWJrZXktPnVzZV9zaGEzODRfaGFzaCgpOyB9CgkJY2FzZSAvcnNhLXNoYTUxMiQvIHsgJHB1YmtleS0+dXNlX3NoYTUxMl9oYXNoKCk7IH0KCQllbHNlIHsgJHB1YmtleS0+dXNlX3NoYTFfaGFzaCgpOyB9Cgl9CgoJbXkgJHZhbGlkID0gJHB1YmtleS0+dmVyaWZ5KCRzZWxmLT57c2lnbmVkX2luZm99LCAkc2lnVmFsdWUpOwoJCgkjJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coUHJpb3JpdHkgPT4gJ2Vycm9yJywgTWVzc2FnZSA9PiAiU0FNTCBERUJVRzogU2lnbmF0dXJlIGlzICIuJHZhbGlkKTsKCQoJcmV0dXJuICR2YWxpZDsKfQoKCnN1YiB2YWxpZGF0ZU51bUFzc2VydGlvbnMoKXsKCW15ICRzZWxmID0gc2hpZnQ7CgkJCglteSBAYXNzZXJ0aW9uTm9kZXMgPSAkc2VsZi0+e3htbF9hc19kb219LT5nZXRFbGVtZW50c0J5VGFnTmFtZSgnc2FtbDpBc3NlcnRpb24nKTsKCXJldHVybiAoc2NhbGFyKEBhc3NlcnRpb25Ob2RlcykgPT0gMSk7Cn0KCgpzdWIgdmFsaWRhdGVUaW1lc3RhbXBzKCl7CglteSAkc2VsZiA9IHNoaWZ0OwoJCQoJbXkgQHRpbWVzdGFtcE5vZGVzID0gJHNlbGYtPnt4bWxfYXNfZG9tfS0+Z2V0RWxlbWVudHNCeVRhZ05hbWUoJ3NhbWw6Q29uZGl0aW9ucycpOwoJZm9yKG15ICRpPTA7ICRpIDwgc2NhbGFyKEB0aW1lc3RhbXBOb2RlcykgOyAkaSsrKXsKCQlteSBAYXR0ciA9ICR0aW1lc3RhbXBOb2Rlc1skaV0tPmF0dHJpYnV0ZXMoKTsKCQkKCQlmb3IobXkgJGo9MDsgJGogPCBzY2FsYXIoQGF0dHIpIDsgJGorKyl7CgkJCWlmKAoJCQkJJGF0dHJbJGpdLT5ub2RlTmFtZSBlcSAiTm90QmVmb3JlIiAmJiAKCQkJCShEYXRlVGltZTo6Rm9ybWF0OjpEYXRlUGFyc2UtPnBhcnNlX2RhdGV0aW1lKCRhdHRyWyRqXS0+dmFsdWUpIC0gRGF0ZVRpbWUtPm5vdygpKS0+aXNfcG9zaXRpdmUoKSAgIAoJCQkpewoJCQkJcmV0dXJuOwoJCQl9CgkJCWlmKAoJCQkJJGF0dHJbJGpdLT5ub2RlTmFtZSBlcSAiTm90T25PckFmdGVyIiAmJiAKCQkJCSEoRGF0ZVRpbWU6OkZvcm1hdDo6RGF0ZVBhcnNlLT5wYXJzZV9kYXRldGltZSgkYXR0clskal0tPnZhbHVlKSAtIERhdGVUaW1lLT5ub3coKSktPmlzX3Bvc2l0aXZlKCkgICAKCQkJKXsKCQkJCXJldHVybjsKCQkJfQoJCX0KCX0KCXJldHVybiAxOwp9CgoKc3ViIGdldF9uYW1laWR7CglteSAkc2VsZiA9IHNoaWZ0OwoJCglteSAkeHBhdGggPSBYTUw6OkxpYlhNTDo6WFBhdGhDb250ZXh0LT5uZXcoJHNlbGYtPnt4bWxfYXNfZG9tfSk7CgkkeHBhdGgtPnJlZ2lzdGVyTnMoInNhbWxwIiwgInVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpwcm90b2NvbCIpOwoJJHhwYXRoLT5yZWdpc3Rlck5zKCJzYW1sIiwgInVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphc3NlcnRpb24iKTsKCW15ICRxdWVyeSA9ICIvc2FtbHA6UmVzcG9uc2Uvc2FtbDpBc3NlcnRpb24vc2FtbDpTdWJqZWN0L3NhbWw6TmFtZUlEIjsKCW15IEBub2RlcyA9ICR4cGF0aC0+ZmluZG5vZGVzKCRxdWVyeSk7CgkKCXJldHVybiAkbm9kZXNbMF0tPnRvU3RyaW5nKCk7Cn0KCgpzdWIgZ2V0X2F0dHJpYnV0ZSgpIHsKCW15ICRzZWxmID0gc2hpZnQ7CglteSAoICRuYW1lICkgPSBAXzsKCQoJbXkgJHhwYXRoID0gWE1MOjpMaWJYTUw6OlhQYXRoQ29udGV4dC0+bmV3KCRzZWxmLT57eG1sX2FzX2RvbX0pOwoJJHhwYXRoLT5yZWdpc3Rlck5zKCJzYW1scCIsICJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6cHJvdG9jb2wiKTsKCSR4cGF0aC0+cmVnaXN0ZXJOcygic2FtbCIsICJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXNzZXJ0aW9uIik7CglteSAkcXVlcnkgPSAnL3NhbWxwOlJlc3BvbnNlL3NhbWw6QXNzZXJ0aW9uL3NhbWw6QXR0cmlidXRlU3RhdGVtZW50L3NhbWw6QXR0cmlidXRlW0BOYW1lPSInLiAkbmFtZSAuJyJdL3NhbWw6QXR0cmlidXRlVmFsdWUnOwoJbXkgQGVudHJpZXMgPSAkeHBhdGgtPmZpbmRub2RlcygkcXVlcnkpOwoKCWlmKHNjYWxhcihAZW50cmllcyk+IDApewoJCWlmKHNjYWxhcihAZW50cmllcykgPiAxKSB7CgkJCW15IEByZXR1cm4gPSAoKTsKCQkJZm9yKG15ICRpPTA7ICRpIDwgc2NhbGFyKEBlbnRyaWVzKTsgJGkrKykgewoJCQkJCXB1c2goQHJldHVybiwgJGVudHJpZXNbJGldLT50ZXh0Q29udGVudCgpKTsKCQkJfQoJCQlyZXR1cm4gQHJldHVybjsKCQl9IGVsc2UgewoJCQlyZXR1cm4gJGVudHJpZXNbMF0tPnRleHRDb250ZW50KCk7CgkJfQoJfWVsc2V7CgkJcmV0dXJuIDsKCX0KfQoKMTs=</File>
    </Filelist>
</otrs_package>